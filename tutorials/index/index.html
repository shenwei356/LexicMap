<!DOCTYPE html>
<html
  lang="en"
  class="color-toggle-hidden"
  
>
  <head>
    <meta charset="UTF-8" />
<meta name="referrer" content="no-referrer" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="color-scheme" content="light dark" />
<meta name="generator" content="Hugo 0.126.1">


  <meta name="description" content="Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names. E.g., GCF_000006945.2.fna.gz Run: From a directory with multiple genome files:
lexicmap index -I genomes/ -O db.lmi From a file list with one file per line:
lexicmap index -X files.txt -O db." />

    <title>Building an index | LexicMap: efficient sequence alignment against millions of prokaryotic genomes​</title>

    <link rel="icon" type="image/svg+xml" href="/LexicMap/favicon/favicon.svg" />
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="/LexicMap/favicon/favicon-32x32.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="/LexicMap/favicon/favicon-16x16.png"
/>

    

    
  <meta
    property="og:title"
    content="Building an index"
  />
  <meta property="og:site_name" content="LexicMap: efficient sequence alignment against millions of prokaryotic genomes\u200b" />
  <meta property="og:description" content="Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names. E.g., GCF_000006945.2.fna.gz Run: From a directory with multiple genome files:
lexicmap index -I genomes/ -O db.lmi From a file list with one file per line:
lexicmap index -X files.txt -O db." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bioinf.shenwei.me/LexicMap/tutorials/index/" />

<meta property="article:section" content="Tutorials" />


  <meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Building an index" />
  <meta name="twitter:description" content="Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names. E.g., GCF_000006945.2.fna.gz Run: From a directory with multiple genome files:
lexicmap index -I genomes/ -O db.lmi From a file list with one file per line:
lexicmap index -X files.txt -O db." />


  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "TechArticle",
      "articleSection": "Tutorials",
      "name": "Building an index",
      "url" : "https://bioinf.shenwei.me/LexicMap/tutorials/index/",
      "headline": "Building an index",
      "description": "Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA\/Q files, with identifiers in the file names. E.g., GCF_000006945.2.fna.gz Run: From a directory with multiple genome files:\nlexicmap index -I genomes\/ -O db.lmi From a file list with one file per line:\nlexicmap index -X files.txt -O db.",
      "wordCount" : "2270",
      "inLanguage": "en",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://bioinf.shenwei.me/LexicMap/tutorials/index/"
      },
      "copyrightHolder" : "LexicMap: efficient sequence alignment against millions of prokaryotic genomes​",
      "copyrightYear" : "0001",
      "dateCreated": "0001-01-01T00:00:00.00Z",
      "datePublished": "0001-01-01T00:00:00.00Z",
      "dateModified": "0001-01-01T00:00:00.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "LexicMap: efficient sequence alignment against millions of prokaryotic genomes​",
          "url": "https://bioinf.shenwei.me/LexicMap/",
          "logo": {
              "@type": "ImageObject",
              "url": "https://bioinf.shenwei.me/LexicMap/brand.svg",
              "width":"32",
              "height":"32"
          }
      }
  }
  </script>


    
  <script src="/LexicMap/js/colortheme-5cd55a83.bundle.min.js"></script>
<script src="/LexicMap/js/main-09678822.bundle.min.js"></script>

<link
  rel="preload"
  as="font"
  href="/LexicMap/fonts/Metropolis.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>
<link
  rel="preload"
  as="font"
  href="/LexicMap/fonts/LiberationSans.woff2"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/LexicMap/main-a559ecaa.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/LexicMap/main-a559ecaa.min.css"
  media="all"
/>

<link
  rel="preload"
  href="/LexicMap/mobile-79ddc617.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/LexicMap/mobile-79ddc617.min.css"
  media="screen and (max-width: 45rem)"
/>

<link
  rel="preload"
  href="/LexicMap/print-735ccc12.min.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/LexicMap/print-735ccc12.min.css"
  media="print"
/>

<link
  rel="preload"
  href="/LexicMap/custom.css"
  as="style"
/>
<link
  rel="stylesheet"
  href="/LexicMap/custom.css"
  media="all"
/>
  <link href="https://bioinf.shenwei.me/LexicMap/tutorials/index/" rel="canonical" type="text/html" />

<!-- Made with Geekdoc theme https://github.com/thegeeklab/hugo-geekdoc -->

    

  </head>

  <body itemscope itemtype="https://schema.org/WebPage">
    
  <!-- geekdoc include: /sprites/geekdoc.svg -->
  <svg class="svg-sprite" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_back" xmlns="http://www.w3.org/2000/svg"><path d="M24 10.526v2.947H5.755l8.351 8.421-2.105 2.105-12-12 12-12 2.105 2.105-8.351 8.421H24z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_left_alt" xmlns="http://www.w3.org/2000/svg"><path d="M5.965 10.526V6.035L0 12l5.965 5.965v-4.491H24v-2.947H5.965z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_arrow_right_alt" xmlns="http://www.w3.org/2000/svg"><path d="M18.035 10.526V6.035L24 12l-5.965 5.965v-4.491H0v-2.947h18.035z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_bitbucket" xmlns="http://www.w3.org/2000/svg"><path d="M15.905 13.355c.189 1.444-1.564 2.578-2.784 1.839-1.375-.602-1.375-2.784-.034-3.403 1.151-.705 2.818.223 2.818 1.564zm1.907-.361c-.309-2.44-3.076-4.056-5.328-3.042-1.426.636-2.389 2.148-2.32 3.747.086 2.097 2.08 3.815 4.176 3.626s3.729-2.234 3.472-4.331zm4.108-9.315c-.756-.997-2.045-1.169-3.179-1.358-3.214-.516-6.513-.533-9.727.034-1.066.172-2.269.361-2.939 1.323 1.1 1.031 2.664 1.186 4.073 1.358 2.544.327 5.156.344 7.699.017 1.426-.172 3.008-.309 4.073-1.375zm.979 17.788c-.481 1.684-.206 3.953-1.994 4.932-3.076 1.701-6.806 1.89-10.191 1.289-1.787-.327-3.884-.894-4.864-2.578-.43-1.65-.705-3.334-.98-5.018l.103-.275.309-.155c5.121 3.386 12.288 3.386 17.427 0 .808.241.206 1.22.189 1.805zM26.01 4.951c-.584 3.764-1.255 7.51-1.908 11.257-.189 1.1-1.255 1.719-2.148 2.183-3.214 1.615-6.96 1.89-10.483 1.512-2.389-.258-4.829-.894-6.771-2.389-.911-.705-.911-1.908-1.083-2.922-.602-3.523-1.289-7.046-1.719-10.604.206-1.547 1.942-2.217 3.231-2.698C6.848.654 8.686.362 10.508.19c3.884-.378 7.854-.241 11.618.859 1.341.395 2.784.945 3.695 2.097.412.533.275 1.203.189 1.805z"/></svg><svg viewBox="-7.27 -7.27 38.55 38.55" id="gdoc_bookmark" xmlns="http://www.w3.org/2000/svg"><path d="M15.268 4.392q.868 0 1.532.638t.664 1.506v17.463l-7.659-3.268-7.608 3.268V6.536q0-.868.664-1.506t1.532-.638h10.876zm4.34 14.144V4.392q0-.868-.638-1.532t-1.506-.664H6.537q0-.868.664-1.532T8.733 0h10.876q.868 0 1.532.664t.664 1.532v17.412z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_auto" xmlns="http://www.w3.org/2000/svg"><path d="M16.846 18.938h2.382L15.22 7.785h-2.44L8.772 18.938h2.382l.871-2.44h3.95zm7.087-9.062L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809zm-11.385 4.937L14 10.282l1.452 4.531h-2.904z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_dark" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565q-1.51 0-3.079.697 1.917.871 3.108 2.701T15.22 14t-1.191 4.037-3.108 2.701q1.568.697 3.079.697zm9.933-11.559L27.999 14l-4.066 4.124v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_brightness_light" xmlns="http://www.w3.org/2000/svg"><path d="M14 21.435q3.079 0 5.257-2.178T21.435 14t-2.178-5.257T14 6.565 8.743 8.743 6.565 14t2.178 5.257T14 21.435zm9.933-3.311v5.809h-5.809L14 27.999l-4.124-4.066H4.067v-5.809L.001 14l4.066-4.124V4.067h5.809L14 .001l4.124 4.066h5.809v5.809L27.999 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check" xmlns="http://www.w3.org/2000/svg"><path d="M8.885 20.197 25.759 3.323l2.24 2.24L8.885 24.677 0 15.792l2.24-2.24z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_check_circle_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm6.441 7.822 1.972 1.972-11.239 11.239L4.207 14l1.972-1.972 4.995 4.995z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_cloud_off" xmlns="http://www.w3.org/2000/svg"><path d="M9.023 10.5H7q-1.914 0-3.281 1.395t-1.367 3.309 1.367 3.281T7 19.852h11.375zM3.5 4.976l1.477-1.477L24.5 23.022l-1.477 1.477-2.352-2.297H6.999q-2.898 0-4.949-2.051t-2.051-4.949q0-2.844 1.969-4.867t4.758-2.133zm19.086 5.578q2.242.164 3.828 1.832T28 16.351q0 3.008-2.461 4.758l-1.695-1.695q1.805-.984 1.805-3.063 0-1.422-1.039-2.461t-2.461-1.039h-1.75v-.602q0-2.68-1.859-4.539t-4.539-1.859q-1.531 0-2.953.711l-1.75-1.695Q11.431 3.5 14.001 3.5q2.953 0 5.496 2.078t3.09 4.977z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_code" xmlns="http://www.w3.org/2000/svg"><path d="M9.917 24.5a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm0-21a1.75 1.75 0 1 0-3.501.001A1.75 1.75 0 0 0 9.917 3.5zm11.666 2.333a1.75 1.75 0 1 0-3.501.001 1.75 1.75 0 0 0 3.501-.001zm1.75 0a3.502 3.502 0 0 1-1.75 3.026c-.055 6.581-4.721 8.039-7.82 9.023-2.898.911-3.846 1.349-3.846 3.117v.474a3.502 3.502 0 0 1 1.75 3.026c0 1.932-1.568 3.5-3.5 3.5s-3.5-1.568-3.5-3.5c0-1.294.711-2.424 1.75-3.026V6.526A3.502 3.502 0 0 1 4.667 3.5c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5a3.502 3.502 0 0 1-1.75 3.026v9.06c.93-.456 1.914-.766 2.807-1.039 3.391-1.075 5.323-1.878 5.359-5.687a3.502 3.502 0 0 1-1.75-3.026c0-1.932 1.568-3.5 3.5-3.5s3.5 1.568 3.5 3.5z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_copy" xmlns="http://www.w3.org/2000/svg"><path d="M23.502 25.438V7.626H9.562v17.812h13.94zm0-20.315q1.013 0 1.787.745t.774 1.757v17.812q0 1.013-.774 1.787t-1.787.774H9.562q-1.013 0-1.787-.774t-.774-1.787V7.625q0-1.013.774-1.757t1.787-.745h13.94zM19.689 0v2.562H4.438v17.812H1.936V2.562q0-1.013.745-1.787T4.438.001h15.251z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_dangerous" xmlns="http://www.w3.org/2000/svg"><path d="M21.802 19.833 15.969 14l5.833-5.833-1.969-1.969L14 12.031 8.167 6.198 6.198 8.167 12.031 14l-5.833 5.833 1.969 1.969L14 15.969l5.833 5.833zM19.833 0 28 8.167v11.666L19.833 28H8.167L0 19.833V8.167L8.167 0h11.666z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_date" xmlns="http://www.w3.org/2000/svg"><path d="M27.192 28.844V11.192H4.808v17.652h22.384zm0-25.689q1.277 0 2.253.976t.976 2.253v22.459q0 1.277-.976 2.216t-2.253.939H4.808q-1.352 0-2.291-.901t-.939-2.253V6.385q0-1.277.939-2.253t2.291-.976h1.577V.001h3.23v3.155h12.769V.001h3.23v3.155h1.577zm-3.155 11.267v3.155h-3.23v-3.155h3.23zm-6.46 0v3.155h-3.155v-3.155h3.155zm-6.384 0v3.155h-3.23v-3.155h3.23z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_download" xmlns="http://www.w3.org/2000/svg"><path d="M2.866 28.209h26.269v3.79H2.866v-3.79zm26.268-16.925L16 24.418 2.866 11.284h7.493V.001h11.283v11.283h7.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_email" xmlns="http://www.w3.org/2000/svg"><path d="M28.845 9.615v-3.23L16 14.422 3.155 6.385v3.23L16 17.577zm0-6.46q1.277 0 2.216.977T32 6.385v19.23q0 1.277-.939 2.253t-2.216.977H3.155q-1.277 0-2.216-.977T0 25.615V6.385q0-1.277.939-2.253t2.216-.977h25.69z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_error_outline" xmlns="http://www.w3.org/2000/svg"><path d="M14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 6.967h2.761v8.413H12.62V6.967zm0 11.239h2.761v2.826H12.62v-2.826z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_fire" xmlns="http://www.w3.org/2000/svg"><path d="M17.689 21.998q-.32.32-.8.576t-.864.384q-1.152.384-2.272.032t-1.888-.992q-.128-.128-.096-.256t.16-.192q1.216-.384 1.92-1.216t.96-1.792q.192-.896-.064-1.728t-.384-1.728q-.128-.704-.096-1.376t.288-1.312q0-.128.128-.128t.192.064q.384.832.992 1.472t1.28 1.216 1.216 1.248.672 1.568q.064.384.064.704.064.96-.32 1.92t-1.088 1.536zm3.84-10.944q-.768-.704-1.6-1.28t-1.6-1.344q-1.536-1.536-2.016-3.584t.16-4.16q.128-.32-.096-.544t-.544-.096q-.768.32-1.44.768t-1.312.896q-1.984 1.664-3.136 3.936T8.633 10.51t.8 5.088q0 .128.032.256t.032.256q0 .576-.512.832t-1.024-.192q-.128-.192-.192-.32-1.024-1.28-1.376-2.912t-.096-3.232q.064-.384-.288-.576t-.608.128q-1.28 1.664-1.856 3.68t-.448 4.064q0 .576.096 1.184t.288 1.184q.448 1.536 1.216 2.816 1.216 2.048 3.264 3.424t4.416 1.696q2.496.32 5.024-.256t4.448-2.304q1.408-1.344 2.208-3.104t.864-3.68-.704-3.712q-.064-.128-.096-.224t-.096-.224q-.576-1.088-1.28-1.984-.256-.384-.544-.704t-.672-.64z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_git" xmlns="http://www.w3.org/2000/svg"><path d="M27.472 12.753 15.247.529a1.803 1.803 0 0 0-2.55 0l-2.84 2.84 2.137 2.137a2.625 2.625 0 0 1 3.501 3.501l3.499 3.499a2.625 2.625 0 1 1-1.237 1.237l-3.499-3.499c-.083.04-.169.075-.257.106v7.3a2.626 2.626 0 1 1-1.75 0v-7.3a2.626 2.626 0 0 1-1.494-3.607L8.62 4.606l-8.09 8.09a1.805 1.805 0 0 0 0 2.551l12.225 12.224a1.803 1.803 0 0 0 2.55 0l12.168-12.168a1.805 1.805 0 0 0 0-2.551z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_gitea" xmlns="http://www.w3.org/2000/svg"><path d="M5.581 7.229c-2.46-.005-5.755 1.559-5.573 5.48.284 6.125 6.56 6.693 9.068 6.743.275 1.149 3.227 5.112 5.412 5.32h9.573c5.741-.381 10.04-17.363 6.853-17.427-5.271.248-8.395.373-11.073.395v5.3l-.835-.369-.005-4.928c-3.075-.001-5.781-.144-10.919-.397-.643-.004-1.539-.113-2.501-.116zm.348 2.166h.293c.349 3.14.917 4.976 2.067 7.781-2.933-.347-5.429-1.199-5.888-4.38-.237-1.647.563-3.365 3.528-3.401zm11.409 3.087c.2.003.404.04.596.128l.999.431-.716 1.305h-.007a.996.996 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006a.767.767 0 0 0 .151.233l-.001-.001-1.235 2.248a.99.99 0 0 0-.302.052l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749 0-.097-.02-.19-.056-.277l.002.006a.784.784 0 0 0-.211-.293l1.203-2.189a.999.999 0 0 0 .397-.041l-.006.002a.942.942 0 0 0 .285-.15l-.001.001c.464.195.844.353 1.117.488.411.203.556.337.6.487.044.147-.004.429-.236.925-.173.369-.46.893-.799 1.511h-.02a.991.991 0 0 0-.321.053l.006-.002c-.349.114-.593.406-.593.749 0 .097.019.189.055.275l-.002-.006c.128.31.457.527.843.527a.987.987 0 0 0 .31-.049l-.006.002c.348-.114.592-.406.592-.749a.703.703 0 0 0-.055-.275l.002.006a.802.802 0 0 0-.183-.27l.001.001c.335-.611.623-1.136.808-1.531.251-.536.381-.935.267-1.32s-.467-.636-.933-.867c-.307-.151-.689-.311-1.147-.503a.723.723 0 0 0-.052-.324l.002.006a.792.792 0 0 0-.194-.279l.704-1.284 3.899 1.684c.704.305.995 1.053.653 1.68l-2.68 4.907c-.343.625-1.184.884-1.888.58l-5.516-2.384c-.704-.304-.996-1.053-.653-1.68l2.68-4.905c.235-.431.707-.687 1.207-.707z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_github" xmlns="http://www.w3.org/2000/svg"><path d="M16 .394c8.833 0 15.999 7.166 15.999 15.999 0 7.062-4.583 13.062-10.937 15.187-.813.146-1.104-.354-1.104-.771 0-.521.021-2.25.021-4.396 0-1.5-.5-2.458-1.083-2.958 3.562-.396 7.312-1.75 7.312-7.896 0-1.75-.625-3.167-1.646-4.291.167-.417.708-2.042-.167-4.25-1.333-.417-4.396 1.646-4.396 1.646a15.032 15.032 0 0 0-8 0S8.937 6.602 7.603 7.018c-.875 2.208-.333 3.833-.167 4.25-1.021 1.125-1.646 2.542-1.646 4.291 0 6.125 3.729 7.5 7.291 7.896-.458.417-.875 1.125-1.021 2.146-.917.417-3.25 1.125-4.646-1.333-.875-1.521-2.458-1.646-2.458-1.646-1.562-.021-.104.979-.104.979 1.042.479 1.771 2.333 1.771 2.333.938 2.854 5.396 1.896 5.396 1.896 0 1.333.021 2.583.021 2.979 0 .417-.292.917-1.104.771C4.582 29.455-.001 23.455-.001 16.393-.001 7.56 7.165.394 15.998.394zM6.063 23.372c.042-.083-.021-.187-.146-.25-.125-.042-.229-.021-.271.042-.042.083.021.187.146.25.104.062.229.042.271-.042zm.646.709c.083-.062.062-.208-.042-.333-.104-.104-.25-.146-.333-.062-.083.062-.062.208.042.333.104.104.25.146.333.062zm.625.937c.104-.083.104-.25 0-.396-.083-.146-.25-.208-.354-.125-.104.062-.104.229 0 .375s.271.208.354.146zm.875.875c.083-.083.042-.271-.083-.396-.146-.146-.333-.167-.417-.062-.104.083-.062.271.083.396.146.146.333.167.417.062zm1.187.521c.042-.125-.083-.271-.271-.333-.167-.042-.354.021-.396.146s.083.271.271.312c.167.062.354 0 .396-.125zm1.313.104c0-.146-.167-.25-.354-.229-.187 0-.333.104-.333.229 0 .146.146.25.354.229.187 0 .333-.104.333-.229zm1.208-.208c-.021-.125-.187-.208-.375-.187-.187.042-.312.167-.292.312.021.125.187.208.375.167s.312-.167.292-.292z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_gitlab" xmlns="http://www.w3.org/2000/svg"><path d="M1.629 11.034 14 26.888.442 17.048a1.09 1.09 0 0 1-.39-1.203l1.578-4.811zm7.217 0h10.309l-5.154 15.854zM5.753 1.475l3.093 9.559H1.63l3.093-9.559a.548.548 0 0 1 1.031 0zm20.618 9.559 1.578 4.811c.141.437-.016.922-.39 1.203l-13.558 9.84 12.371-15.854zm0 0h-7.216l3.093-9.559a.548.548 0 0 1 1.031 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_heart" xmlns="http://www.w3.org/2000/svg"><path d="M16 29.714a1.11 1.11 0 0 1-.786-.321L4.072 18.643c-.143-.125-4.071-3.714-4.071-8 0-5.232 3.196-8.357 8.535-8.357 3.125 0 6.053 2.464 7.464 3.857 1.411-1.393 4.339-3.857 7.464-3.857 5.339 0 8.535 3.125 8.535 8.357 0 4.286-3.928 7.875-4.089 8.035L16.785 29.392c-.214.214-.5.321-.786.321z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_home" xmlns="http://www.w3.org/2000/svg"><path d="M24.003 15.695v8.336c0 .608-.504 1.111-1.111 1.111h-6.669v-6.669h-4.446v6.669H5.108a1.119 1.119 0 0 1-1.111-1.111v-8.336c0-.035.017-.069.017-.104L14 7.359l9.986 8.232a.224.224 0 0 1 .017.104zm3.873-1.198-1.077 1.285a.578.578 0 0 1-.365.191h-.052a.547.547 0 0 1-.365-.122L14 5.831 1.983 15.851a.594.594 0 0 1-.417.122.578.578 0 0 1-.365-.191L.124 14.497a.57.57 0 0 1 .069-.781L12.679 3.314c.729-.608 1.91-.608 2.64 0l4.237 3.543V3.471c0-.313.243-.556.556-.556h3.334c.313 0 .556.243.556.556v7.085l3.803 3.161c.226.191.26.556.069.781z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_info_outline" xmlns="http://www.w3.org/2000/svg"><path d="M12.62 9.793V6.967h2.761v2.826H12.62zM14 25.239q4.601 0 7.92-3.319T25.239 14 21.92 6.08 14 2.761 6.08 6.08 2.761 14t3.319 7.92T14 25.239zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0zm-1.38 21.033V12.62h2.761v8.413H12.62z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_down" xmlns="http://www.w3.org/2000/svg"><path d="M3.281 5.36 14 16.079 24.719 5.36 28 8.641l-14 14-14-14z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_left" xmlns="http://www.w3.org/2000/svg"><path d="M25.875 28.25 22.125 32 6.126 16.001 22.125.002l3.75 3.75-12.25 12.25z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_keyboard_arrow_right" xmlns="http://www.w3.org/2000/svg"><path d="M6.125 28.25 18.375 16 6.125 3.75 9.875 0l15.999 15.999L9.875 31.998z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_keyboard_arrow_up" xmlns="http://www.w3.org/2000/svg"><path d="M24.719 22.64 14 11.921 3.281 22.64 0 19.359l14-14 14 14z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_language" xmlns="http://www.w3.org/2000/svg"><path d="M20.112 16.826h4.732q.394-1.84.394-2.826t-.394-2.826h-4.732q.197 1.38.197 2.826t-.197 2.826zm-2.497 7.756q1.643-.526 3.418-2.005t2.695-2.991h-4.141q-.657 2.629-1.972 4.995zm-.329-7.756q.197-1.38.197-2.826t-.197-2.826h-6.573q-.197 1.38-.197 2.826t.197 2.826h6.573zM14 25.173q1.84-2.695 2.695-5.587h-5.39q.854 2.892 2.695 5.587zM8.413 8.413q.789-2.826 1.972-4.995-1.643.526-3.451 2.005T4.272 8.414h4.141zM4.272 19.587q.854 1.512 2.662 2.991t3.451 2.005q-1.315-2.366-1.972-4.995H4.272zm-1.117-2.761h4.732Q7.69 15.446 7.69 14t.197-2.826H3.155q-.394 1.84-.394 2.826t.394 2.826zM14 2.826q-1.84 2.695-2.695 5.587h5.39Q15.841 5.521 14 2.826zm9.727 5.587q-.92-1.512-2.695-2.991t-3.418-2.005q1.183 2.169 1.972 4.995h4.141zM14 0q5.784 0 9.892 4.108T28 14t-4.108 9.892T14 28t-9.892-4.108T0 14t4.108-9.892T14 0z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_link" xmlns="http://www.w3.org/2000/svg"><path d="M24.037 7.963q3.305 0 5.634 2.366T32 16t-2.329 5.671-5.634 2.366h-6.46v-3.08h6.46q2.028 0 3.493-1.465t1.465-3.493-1.465-3.493-3.493-1.465h-6.46v-3.08h6.46zM9.615 17.578v-3.155h12.77v3.155H9.615zM3.005 16q0 2.028 1.465 3.493t3.493 1.465h6.46v3.08h-6.46q-3.305 0-5.634-2.366T0 16.001t2.329-5.671 5.634-2.366h6.46v3.08h-6.46q-2.028 0-3.493 1.465t-1.465 3.493z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_mastodon" xmlns="http://www.w3.org/2000/svg"><path d="M30.924 10.506c0-6.941-4.548-8.976-4.548-8.976C24.083.477 20.144.034 16.054.001h-.101C11.862.034 7.926.477 5.633 1.53c0 0-4.548 2.035-4.548 8.976 0 1.589-.031 3.491.02 5.505.165 6.79 1.245 13.479 7.522 15.14 2.893.765 5.379.927 7.38.816 3.629-.2 5.667-1.296 5.667-1.296l-.12-2.633s-2.593.817-5.505.719c-2.887-.099-5.932-.311-6.399-3.855a7.069 7.069 0 0 1-.064-.967v-.028.001s2.833.693 6.423.857c2.195.1 4.253-.129 6.344-.377 4.009-.479 7.5-2.949 7.939-5.207.689-3.553.633-8.676.633-8.676zm-5.366 8.945h-3.329v-8.159c0-1.72-.724-2.592-2.171-2.592-1.6 0-2.403 1.035-2.403 3.083v4.465h-3.311v-4.467c0-2.048-.803-3.083-2.403-3.083-1.447 0-2.171.873-2.171 2.592v8.159H6.441v-8.404c0-1.719.437-3.084 1.316-4.093.907-1.011 2.092-1.528 3.565-1.528 1.704 0 2.995.655 3.848 1.965l.828 1.391.829-1.391c.853-1.311 2.144-1.965 3.848-1.965 1.472 0 2.659.517 3.565 1.528.877 1.009 1.315 2.375 1.315 4.093z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_matrix" xmlns="http://www.w3.org/2000/svg"><path d="M.843.734v30.532H3.04v.733H0V0h3.04v.733zm9.391 9.68v1.543h.044a4.417 4.417 0 0 1 1.489-1.365c.577-.327 1.248-.487 2-.487.72 0 1.377.143 1.975.419.597.277 1.047.776 1.36 1.477.339-.499.8-.941 1.379-1.323.579-.383 1.267-.573 2.061-.573.604 0 1.163.075 1.68.223a3.34 3.34 0 0 1 1.324.707c.368.327.652.745.861 1.268.203.523.307 1.151.307 1.889v7.637h-3.132v-6.468c0-.381-.013-.745-.043-1.083a2.315 2.315 0 0 0-.246-.893l.006.013a1.484 1.484 0 0 0-.577-.593l-.007-.004c-.259-.147-.609-.221-1.047-.221-.443 0-.8.085-1.071.252-.267.166-.483.39-.635.656l-.005.009a2.558 2.558 0 0 0-.307.915l-.002.013a7.156 7.156 0 0 0-.08 1.044v6.359h-3.133v-6.4c0-.339-.005-.671-.024-1.003a2.772 2.772 0 0 0-.197-.936l.007.019a1.41 1.41 0 0 0-.548-.667l-.006-.003c-.259-.167-.635-.253-1.139-.253-.148 0-.345.032-.585.099-.24.068-.48.191-.707.376-.228.184-.425.449-.585.793-.16.345-.24.8-.24 1.36v6.621H7.279v-11.42zm20.923 20.852V.734H28.96V.001H32V32h-3.04v-.733z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_menu" xmlns="http://www.w3.org/2000/svg"><path d="M.001 5.334h31.998v3.583H.001V5.334zm0 12.416v-3.5h31.998v3.5H.001zm0 8.916v-3.583h31.998v3.583H.001z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_notification" xmlns="http://www.w3.org/2000/svg"><path d="m22.615 19.384 2.894 2.894v1.413H2.49v-1.413l2.894-2.894V12.25q0-3.365 1.716-5.856t4.745-3.231v-1.01q0-.875.606-1.514T13.999 0t1.548.639.606 1.514v1.01q3.029.74 4.745 3.231t1.716 5.856v7.134zM14 27.999q-1.211 0-2.053-.808t-.841-2.019h5.788q0 1.144-.875 1.986T14 27.999z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_path" xmlns="http://www.w3.org/2000/svg"><path d="M28 12.62h-9.793V8.414h-2.826v11.173h2.826v-4.206H28V26.62h-9.793v-4.206H12.62v-14H9.794v4.206H.001V1.381h9.793v4.206h8.413V1.381H28V12.62z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_person" xmlns="http://www.w3.org/2000/svg"><path d="M16 20.023q5.052 0 10.526 2.199t5.473 5.754v4.023H0v-4.023q0-3.555 5.473-5.754t10.526-2.199zM16 16q-3.275 0-5.614-2.339T8.047 8.047t2.339-5.661T16 0t5.614 2.386 2.339 5.661-2.339 5.614T16 16z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_search" xmlns="http://www.w3.org/2000/svg"><path d="M11.925 20.161q3.432 0 5.834-2.402t2.402-5.834-2.402-5.834-5.834-2.402-5.834 2.402-2.402 5.834 2.402 5.834 5.834 2.402zm10.981 0L32 29.255 29.255 32l-9.094-9.094v-1.458l-.515-.515q-3.26 2.831-7.721 2.831-4.976 0-8.45-3.432T.001 11.925t3.474-8.45 8.45-3.474 8.407 3.474 3.432 8.45q0 1.802-.858 4.075t-1.973 3.646l.515.515h1.458z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_shield" xmlns="http://www.w3.org/2000/svg"><path d="M22.167 15.166V3.5h-8.166v20.726c.93-.492 2.424-1.349 3.883-2.497 1.95-1.531 4.284-3.919 4.284-6.562zm3.499-13.999v14c0 7.674-10.737 12.523-11.192 12.724-.146.073-.31.109-.474.109s-.328-.036-.474-.109c-.456-.201-11.192-5.049-11.192-12.724v-14C2.334.529 2.863 0 3.501 0H24.5c.638 0 1.167.529 1.167 1.167z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_star" xmlns="http://www.w3.org/2000/svg"><path d="M14 22.052 5.324 27.31l2.3-9.859L0 10.813l10.056-.854L14 .692l3.944 9.267L28 10.813l-7.624 6.638 2.3 9.859z"/></svg><svg viewBox="-7.27 -7.27 42.55 42.55" id="gdoc_tag" xmlns="http://www.w3.org/2000/svg"><path d="M17.52 17.52v-7.041h-7.041v7.041h7.041zM28 10.479h-7.041v7.041H28v3.439h-7.041V28H17.52v-7.041h-7.041V28H7.04v-7.041H-.001V17.52H7.04v-7.041H-.001V7.04H7.04V-.001h3.439V7.04h7.041V-.001h3.439V7.04H28v3.439z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_timer" xmlns="http://www.w3.org/2000/svg"><path d="M16 29q4.428 0 7.536-3.143t3.107-7.571-3.107-7.536T16 7.643 8.464 10.75t-3.107 7.536 3.107 7.571T16 29zM26.714 9.786q1.214 1.571 2.107 4.036t.893 4.464q0 5.643-4 9.678T16 32t-9.714-4.036-4-9.678 4-9.678T16 4.572q1.929 0 4.464.929t4.107 2.143l2.143-2.214q1.143.929 2.143 2.143zM14.5 19.857v-9.143h3v9.143h-3zM20.571.001v3.071h-9.143V.001h9.143z"/></svg><svg viewBox="-7.27 -7.27 46.55 46.55" id="gdoc_xmpp" xmlns="http://www.w3.org/2000/svg"><path d="M31.995 4.237c-.449.175-1.12.433-1.936.745-1.544.591-2.328.891-2.924 1.093-.613.208-1.287.409-2.635.813-.911.272-1.672.495-2.212.651-.031.875 0 2.177-.292 3.635a21.837 21.837 0 0 1-2.016 5.765c-1.496 2.944-3.236 4.817-3.88 5.476-.056-.059-.112-.117-.168-.179-.707-.763-2.403-2.703-3.815-5.683-1.053-2.223-1.484-4.044-1.605-4.584-.356-1.589-.427-2.955-.427-4.117 0-.075-.036-.129-.101-.149-.721-.223-1.765-.519-2.887-.853-1.271-.379-2.193-.744-3.408-1.2-.493-.185-1.409-.547-2.217-.859C.723 4.499.113 4.236.041 4.236c-.005 0-.015 0-.023.012a.131.131 0 0 0-.019.076c.009.593.08 1.361.256 2.365.615 3.503 2.688 7.061 4.36 9.244 0 0 3.717 5.035 9.128 8.144l.303.176c-.009.008-.02.015-.028.021-1.717 1.316-3.201 1.977-3.579 2.14a15.71 15.71 0 0 1-2.219.772v.407a25.31 25.31 0 0 0 2.72-.487 26.72 26.72 0 0 0 5.075-1.792c.136.067.276.136.42.204 1.527.725 3.571 1.627 6.073 2.048.613.103 1.136.165 1.507.195a.109.109 0 0 0 .115-.091.55.55 0 0 0 .004-.217.107.107 0 0 0-.063-.073c-.505-.209-1.201-.4-1.983-.719-.935-.381-2.241-1.067-3.648-2.128a13.528 13.528 0 0 1-.367-.287c4.64-2.656 7.989-6.588 7.989-6.588 1.735-2.036 4.441-5.623 5.431-9.795.349-1.473.539-2.741.5-3.628z"/></svg></defs></svg>




    <div
      class="wrapper "
    >
      <input type="checkbox" class="hidden" id="menu-control" />
      <input type="checkbox" class="hidden" id="menu-header-control" />
      
      <header class="gdoc-header">
  <div class="container flex align-center justify-between">
    
      <label for="menu-control" class="gdoc-nav__control" tabindex="0">
        <svg class="gdoc-icon gdoc_menu">
          <title>Open Navigation</title>
          <use xlink:href="#gdoc_menu"></use>
        </svg>
        <svg class="gdoc-icon gdoc_arrow_back">
          <title>Close Navigation</title>
          <use xlink:href="#gdoc_arrow_back"></use>
        </svg>
      </label>
    
    <div>
      <a class="gdoc-brand gdoc-header__link" href="https://bioinf.shenwei.me/LexicMap/">
        <span class="flex align-center">
          <img
            class="gdoc-brand__img"
            src="/LexicMap/logo.svg"
            alt=""
          />
          <span class="gdoc-brand__title">LexicMap: efficient sequence alignment against millions of prokaryotic genomes​</span>
        </span>
      </a>
    </div>
    <div class="gdoc-menu-header">
      <span class="gdoc-menu-header__items">
        
          

  
  
  
  

  
    
      
      
      

      
      

      

      
        <span>
          <a
            href="https://github.com/shenwei356/LexicMap"
            class="gdoc-header__link"
          >
            <svg class="gdoc-icon gdoc_github">
              <title>GitHub</title>
              <use xlink:href="#gdoc_github"></use>
            </svg>
          </a>
        </span>
      
    
  






        


        <span id="gdoc-color-theme">
          <svg class="gdoc-icon gdoc_brightness_dark">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_dark"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_light">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_light"></use>
          </svg>
          <svg class="gdoc-icon gdoc_brightness_auto">
            <title>Toggle Dark/Light/Auto mode</title>
            <use xlink:href="#gdoc_brightness_auto"></use>
          </svg>
        </span>

        <span class="gdoc-menu-header__home">
          <a href="https://bioinf.shenwei.me/LexicMap/" class="gdoc-header__link">
            <svg class="gdoc-icon gdoc_home">
              <title>Back to homepage</title>
              <use xlink:href="#gdoc_home"></use>
            </svg>
          </a>
        </span>

        



        <span class="gdoc-menu-header__control">
          <label for="menu-header-control">
            <svg class="gdoc-icon gdoc_keyboard_arrow_right">
              <use xlink:href="#gdoc_keyboard_arrow_right"></use>
              <title>Close Menu Bar</title>
            </svg>
          </label>
        </span>
      </span>
      <label for="menu-header-control" class="gdoc-menu-header__control">
        <svg class="gdoc-icon gdoc_keyboard_arrow_left">
          <use xlink:href="#gdoc_keyboard_arrow_left"></use>
          <title>Open Menu Bar</title>
        </svg>
      </label>
    </div>
  </div>
</header>



      <main class="container flex flex-even">
        
          <aside class="gdoc-nav">
            <nav>
  
  <div class="gdoc-search flex align-center">
    <svg class="gdoc-icon gdoc_search"><use xlink:href="#gdoc_search"></use></svg>
    <input
      type="text"
      id="gdoc-search-input"
      class="gdoc-search__input"
      placeholder="Search..."
      aria-label="Search"
      maxlength="64"
      data-site-base-url="https://bioinf.shenwei.me/LexicMap/"
      data-site-lang="en"
    />
    <ul id="gdoc-search-results" class="gdoc-search__list"></ul>
  </div>




  <section class="gdoc-nav--main">
    <h2>Navigation</h2>
    
      

  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/introduction/"
                    class="gdoc-nav__entry"
                  >
                    Introduction
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/quick-start/"
                    class="gdoc-nav__entry"
                  >
                    Quick start
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/installation/"
                    class="gdoc-nav__entry"
                  >
                    Installation
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/releases/"
                    class="gdoc-nav__entry"
                  >
                    Releases
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Tutorials</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/tutorials/index/"
                    class="gdoc-nav__entry is-active"
                  >
                    Building an index
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/tutorials/search/"
                    class="gdoc-nav__entry"
                  >
                    Searching
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Usage</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/lexicmap/"
                    class="gdoc-nav__entry"
                  >
                    lexicmap
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/index/"
                    class="gdoc-nav__entry"
                  >
                    index
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/search/"
                    class="gdoc-nav__entry"
                  >
                    search
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="gdoc-nav__toggle" id="navtree-bc817233"
                
              
            />
            <label
              
                for="navtree-bc817233" class="flex justify-between align-center"
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/"
                    class="gdoc-nav__entry"
                  >
                    utils
                  </a>
                </span>
              
              
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_left">
                  <use xlink:href="#gdoc_keyboard_arrow_left"></use>
                </svg>
                <svg class="gdoc-icon toggle gdoc_keyboard_arrow_down">
                  <use xlink:href="#gdoc_keyboard_arrow_down"></use>
                </svg>
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/masks/"
                    class="gdoc-nav__entry"
                  >
                    masks
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/kmers/"
                    class="gdoc-nav__entry"
                  >
                    kmers
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/genomes/"
                    class="gdoc-nav__entry"
                  >
                    genomes
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/subseq/"
                    class="gdoc-nav__entry"
                  >
                    subseq
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/seed-pos/"
                    class="gdoc-nav__entry"
                  >
                    seed-pos
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/usage/utils/reindex-seeds/"
                    class="gdoc-nav__entry"
                  >
                    reindex-seeds
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/faqs/"
                    class="gdoc-nav__entry"
                  >
                    FAQs
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">Notes</span>
              
              
            </label>

            
              
  


  <ul class="gdoc-nav__list">
    
    
      

      
        
      

      
        
          
          
          
          
          
          


          <li>
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              
                <span class="flex">
                  <a
                    href="/LexicMap/notes/motivation/"
                    class="gdoc-nav__entry"
                  >
                    Motivation
                  </a>
                </span>
              
              
            </label>

            
          </li>
        
      
    
  </ul>

            
          </li>
        
      
    
  </ul>






    
  </section>

  


  <section class="gdoc-nav--more">
    
      <h2>More</h2>
      

  
  


  <ul class="gdoc-nav__list">
    
      
      


      <li>
        
        
          
          
          
          
          
          
          

          
          

          
            <input
              type="checkbox"
              
                class="hidden"
              
            />
            <label
              
            >
              <span class="flex">
                
                  <svg class="gdoc-icon gdoc_github"><use xlink:href="#gdoc_github"></use></svg>
                
                <a
                  href="https://github.com/shenwei356"
                  class="gdoc-nav__entry"
                >
                  More tools
                </a>
              </span>
              
            </label>
          
        

        
      </li>
    
  </ul>






    
  </section>
</nav>

          </aside>
        


        <div class="gdoc-page">
          
  


  






<div
  class="gdoc-page__header flex flex-wrap
  
    justify-between
  
  hidden-mobile
  "
  itemprop="breadcrumb"
>
  
    <div>
      <svg class="gdoc-icon gdoc_path hidden-mobile"><use xlink:href="#gdoc_path"></use></svg>
      <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
        
        
        
        
  
  
    
    
    
    
  
  
    
    
    
    
  
  
    <li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><a itemscope itemtype='https://schema.org/WebPage' itemprop='item' itemid='/LexicMap/' href='/LexicMap/'><span itemprop='name'></span></a><meta itemprop='position' content='2' /></li><li> / </li><li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><a itemscope itemtype='https://schema.org/WebPage' itemprop='item' itemid='/LexicMap/tutorials/' href='/LexicMap/tutorials/'><span itemprop='name'>Tutorials</span></a><meta itemprop='position' content='3' /></li><li> / </li><li itemprop='itemListElement' itemscope itemtype='https://schema.org/ListItem'><span itemprop='name'>Building an index</span><meta itemprop='position' content='4' /></li>
  

  

  

      </ol>
    </div>
  
  
</div>



  <article
    class="gdoc-markdown gdoc-markdown__align--left"
  >
    <h1>Building an index</h1>
    <div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="table-of-contents"
    >
        Table of contents
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#table-of-contents" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Table of contents" aria-label="Anchor to: Table of contents" href="#table-of-contents">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<div class="gdoc-toc gdoc-toc__level--3">
      <nav id="TableOfContents"><ul>
        <li><a href="#table-of-contents">Table of contents</a></li>
        <li><a href="#tldr">TL;DR</a></li>
        <li><a href="#input">Input</a></li>
        <li><a href="#hardware-requirements">Hardware requirements</a></li>
        <li><a href="#algorithm">Algorithm</a></li>
        <li><a href="#parameters">Parameters</a></li>
        <li><a href="#steps">Steps</a></li>
        <li><a href="#output">Output</a>
          <ul>
            <li><a href="#file-structure">File structure</a></li>
            <li><a href="#index-size">Index size</a></li>
          </ul>
        </li>
      </ul></nav>
      <hr />
    </div>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="tldr"
    >
        TL;DR
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#tldr" class="gdoc-page__anchor clip flex align-center" title="Anchor to: TL;DR" aria-label="Anchor to: TL;DR" href="#tldr">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<ol>
<li>Prepare input files:
<ul>
<li><strong>Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names</strong>.
E.g., GCF_000006945.2.fna.gz</li>
</ul>
</li>
<li>Run:
<ul>
<li>
<p>From a directory with multiple genome files:</p>
<pre><code>lexicmap index -I genomes/ -O db.lmi
</code></pre>
</li>
<li>
<p>From a file list with one file per line:</p>
<pre><code>lexicmap index -X files.txt -O db.lmi
</code></pre>
</li>
</ul>
</li>
</ol>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="input"
    >
        Input
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#input" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Input" aria-label="Anchor to: Input" href="#input">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>





<blockquote class="gdoc-hint note">
  <div class="gdoc-hint__title flex align-center"><i class="fa note" title="Note"></i></div>
  <div class="gdoc-hint__text"><strong>Genome size</strong><br>
LexicMap is only suitable for small genomes like Archaea, Bacteria, Viruses and plasmids.</div>
</blockquote>

<p><strong>Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names</strong>.</p>
<ul>
<li><strong>File type</strong>: FASTA/Q files, in plain text or gzip-compressed format.</li>
<li><strong>File name</strong>: &ldquo;Genome ID&rdquo; + &ldquo;File extention&rdquo;. E.g., <code>GCF_000006945.2.fa.gz</code>.
<ul>
<li><strong>Genome ID</strong>: they should be distinct for accurate result interpretation, which will be shown in the search result.</li>
<li>File extention: a regular expression set by the flag <code>-N/--ref-name-regexp</code> is used to extract genome IDs from the file name.
The default value supports common sequence file extentions, including <code>.fa</code>, <code>.fasta</code>, <code>.fna</code>, <code>.fa.gz</code>, <code>.fasta.gz</code>, and <code>.fna.gz</code>.</li>
</ul>
</li>
<li><strong>Sequences</strong>:
<ul>
<li><strong>Only DNA or RNA sequences are supported</strong>.</li>
<li><strong>Sequence IDs</strong> should be distinct for accurate result interpretation, which will be shown in the search result.</li>
<li>One or more sequences are allowed.
<ul>
<li>Unwanted sequences can be filtered out by regular expressions from the flag <code>-B/--seq-name-filter</code>.</li>
</ul>
</li>
<li><strong>Genome size limit</strong>. Some none-isolate assemblies might have extremely large genomes, e.g., <a
  class="gdoc-markdown__link"
  href="https://www.ncbi.nlm.nih.gov/datasets/genome/GCA_000765055.1/"
>GCA_000765055.1</a> has &gt;150 Mb.
The flag <code>-g/--max-genome</code> (default 15 Mb) is used to skip these input files, and the file list would be written to a file
via the flag <code>-G/--big-genomes</code>.</li>
</ul>
</li>
<li><strong>At most 17,179,869,184 (2<sup>34</sup>) genomes are supported</strong>. For more genomes, just build multiple indexes.</li>
</ul>
<p><strong>Input files can be given via one of the following ways:</strong></p>
<ul>
<li><strong>Positional arguments</strong>. For a few input files.</li>
<li>A <strong>file list</strong> via the flag <code>-X/--infile-list</code>  with one file per line.
It can be STDIN (<code>-</code>), e.g., you can filter a file list and pass it to <code>lexicmap index</code>.
The flag <code>-S/--skip-file-check</code> is optional for skiping input file checking if you believe these files do exist.</li>
<li>A <strong>directory</strong> containing input files via the flag <code>-I/--in-dir</code>.
<ul>
<li>Multiple-level directories are supported.</li>
<li>Directory and file symlinks are followed.</li>
</ul>
</li>
</ul>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="hardware-requirements"
    >
        Hardware requirements
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#hardware-requirements" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Hardware requirements" aria-label="Anchor to: Hardware requirements" href="#hardware-requirements">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>LexicMap is designed to provide fast and low-memory sequence alignment against millions of prokaryotic genomes.</p>
<ul>
<li><strong>CPU:</strong>
<ul>
<li>No specific requirements on CPU type and instruction sets. Both x86 and ARM chips are supported.</li>
<li>More is better as LexicMap is a CPU-intensive software. It uses all CPUs by default (<code>-j/--threads</code>).</li>
</ul>
</li>
<li><strong>RAM</strong>
<ul>
<li>More RAM (&gt; 50 GB) is preferred. The memory usage in index building is mainly related to:
<ul>
<li>The number of masks (<code>-m/--masks</code>, default 40,000).</li>
<li>The number of genomes.</li>
<li>The divergence between genome sequences.</li>
<li><strong>The genome batch size</strong>  (<code>-b/--batch-size</code>, default 10,000). This is the main parameter to adjust memory usage.</li>
</ul>
</li>
<li>If the RAM is not sufficient (&lt; 50 GB). Please:
<ol>
<li>Use a smaller genome batch size. It decreases indexing memory occupation and has little effect on searching performance.</li>
<li>Use a smaller number of masks, e.g., 20,000 performs well for small genomes (&lt;=5 Mb). And if the queries are long (&gt;= 2kb), there&rsquo;s little affection for the alignment results.</li>
</ol>
</li>
</ul>
</li>
<li><strong>Disk</strong>
<ul>
<li>More (&gt;2 TB) is better. The index size is related to the input genomes and the number of masks. See <a
  class="gdoc-markdown__link"
  href="#index-size"
>some examples</a>.</li>
<li>SSD disks are preferred, while HDD disks are also fast enough.</li>
</ul>
</li>
</ul>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="algorithm"
    >
        Algorithm
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#algorithm" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Algorithm" aria-label="Anchor to: Algorithm" href="#algorithm">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<img src="/LexicMap/indexing.svg" alt="" width="900"/>
<ol>
<li>
<p><strong>Generating <em>m</em> <a
  class="gdoc-markdown__link"
  href="https://doi.org/10.1093/bioinformatics/btad652"
>LexicHash masks</a></strong>.</p>
<ol>
<li>Generate <em>m</em> prefixes.
<ol>
<li>Generating all permutations of <em>p</em>-bp prefixes that can cover all possible k-mers, <em>p</em> is the biggest value for 4<sup><em>p</em></sup> &lt;= <em>m</em> (desired number of masks), e.g., <em>p</em>=7 for 40,000 masks.</li>
<li>Removing low-complexity prefixes. E.g., 16176 out of 16384 (4^7) prefixes are left.</li>
<li>Duplicating these prefixes to <em>m</em> prefixes.</li>
</ol>
</li>
<li>For each prefixes,
<ol>
<li>Randomly generating left <em>k</em>-<em>p</em> bases.</li>
<li>If the <em>P</em>-prefix (<code>-p/--seed-min-prefix</code>) is of low-complexity, re-generating. <em>P</em> is the minimum length of substring matches, default 15.</li>
<li>If the mask is duplicated, re-generating.</li>
</ol>
</li>
</ol>
</li>
<li>
<p><strong>Building an index for each genome batch</strong> (<code>-b/--batch-size</code>, default 10000, max 131072).</p>
<ol>
<li>For each genome file in a genome batch.
<ol>
<li>Optionally discarding sequences via regular expression (<code>-B/--seq-name-filter</code>).</li>
<li>Skipping genomes bigger than the value of <code>-g/--max-genome</code>.</li>
<li>Concatenating all sequences, with intervals of 1000-bp N&rsquo;s.</li>
<li>Capturing the most similar k-mer for each mask and recording the k-mer and its location(s) and strand information. Base N is treated as A.</li>
<li>Filling sketching deserts (genome regions longer than <code>--seed-max-desert</code> without any captured k-mers/seeds).
In a sketching desert, not a single k-mer is captured because there&rsquo;s another k-mer in another place which shares a longer prefix with the mask.
As a result, for a query similar to seqs in this region, all captured k-mers can’t match the correct seeds.
<ol>
<li>For a desert region (<code>start</code>, <code>end</code>), counting frequencies of <em>P</em>-mers in the extended region (<code>start-1000</code>, <code>end+1000</code>), <em>P</em>=15 by default.</li>
<li>Starting from <code>start</code>, every around <code>--seed-in-desert-dist</code> (default 200) bp, finding a k-mer of which the <em>P</em>-prefix is distinct with a frequency of 1 (from the previous step).
This guarantees the k-mer will be captured by a mask in query sequences similar to the region.</li>
<li>Adding the new k-mer to the mask which has the biggest chance to capture it.
So in the search step, the new k-mer will be captured by this mask, and it will match the correst seed (itsself) in the seed data of the mask.
<ol>
<li>Find candidate masks via a lookup table (mapping mask prefixes to masks).</li>
<li>Choose the mask of which the captured k-mer share the longest prefix as the new k-mer,
by compring LexicHash values (new k-mer XOR captured k-mer).</li>
</ol>
</li>
</ol>
</li>
<li>Saving the concatenated genome sequence (bit-packed, 2 bits for one base, N is treated as A) and genome information (genome ID, size, and lengths of all sequences) into the genome data file, and creating an index file for the genome data file for fast random subsequence extraction.</li>
</ol>
</li>
<li>Compressing k-mers and the corresponding data (k-mer-data, or seeds data, including genome batch, genome number, location, and strand) into chunks of files, and creating an index file for each k-mer-data file for fast seeding.</li>
<li>Writing summary information into <code>info.toml</code> file.</li>
</ol>
</li>
<li>
<p><strong>Merging indexes of multiple batches</strong>.</p>
<ol>
<li>For each k-mer-data chunk file (belonging to a list of masks), serially reading data of each mask from all batches,
merging them and writting to a new file.</li>
<li>For genome data files, just moving them.</li>
<li>Concatenating <code>genomes.map.bin</code>, which maps each genome ID to its batch ID and index in the batch.</li>
<li>Update the index summary file.</li>
</ol>
</li>
</ol>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="parameters"
    >
        Parameters
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#parameters" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Parameters" aria-label="Anchor to: Parameters" href="#parameters">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p><strong>Flags in bold text</strong> are important and frequently used.</p>



<div class="gdoc-tabs">
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t1"
      id="tabs-t1-0"
      checked="checked"
    />
    <label for="tabs-t1-0" class="gdoc-tabs__label">
      Genome batches
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <div class="table-wrap"> <table>
<thead>
<tr>
<th style="text-align:left">Flag</th>
<th style="text-align:left">Value</th>
<th style="text-align:left">Function</th>
<th style="text-align:left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>-b/--batch-size</code></strong></td>
<td style="text-align:left">Max: 131072, default: 10000</td>
<td style="text-align:left">Maximum number of genomes in each batch</td>
<td style="text-align:left">If the number of input files exceeds this number, input files are split into multiple batches and indexes are built for all batches. In the end, seed files are merged, while genome data files are kept unchanged and collected. ► Bigger values increase indexing memory occupation</td>
</tr>
</tbody>
</table> </div>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t1"
      id="tabs-t1-1"
      
    />
    <label for="tabs-t1-1" class="gdoc-tabs__label">
      LexicHash mask generation
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <div class="table-wrap"> <table>
<thead>
<tr>
<th style="text-align:left">Flag</th>
<th style="text-align:left">Value</th>
<th style="text-align:left">Function</th>
<th style="text-align:left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>-M/--mask-file</code></td>
<td style="text-align:left">A file</td>
<td style="text-align:left">File with custom masks</td>
<td style="text-align:left">File with custom masks, which could be exported from an existing index or newly generated by &ldquo;lexicmap utils masks&rdquo;. This flag oversides -k/&ndash;kmer, -m/&ndash;masks, -s/&ndash;rand-seed, et al.</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>-k/--kmer</code></strong></td>
<td style="text-align:left">Max: 32, default: 31</td>
<td style="text-align:left">K-mer size</td>
<td style="text-align:left">► Bigger values improve the search specificity and do not increase the index size.</td>
</tr>
<tr>
<td style="text-align:left"><strong><code>-m/--masks</code></strong></td>
<td style="text-align:left">Default: 40000</td>
<td style="text-align:left">Number of masks</td>
<td style="text-align:left">► Bigger values improve the search sensitivity, increase the index size, and slow down the search speed.</td>
</tr>
<tr>
<td style="text-align:left"><code>-p/--seed-min-prefix</code></td>
<td style="text-align:left">Max: 32, Default: 15</td>
<td style="text-align:left">Minimum length of shared substrings (anchors) in searching</td>
<td style="text-align:left">This value is used to remove masks with a prefix of low-complexity and choose k-mers to fill sketching deserts.</td>
</tr>
</tbody>
</table> </div>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t1"
      id="tabs-t1-2"
      
    />
    <label for="tabs-t1-2" class="gdoc-tabs__label">
      Seeds (k-mer-value) data
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <div class="table-wrap"> <table>
<thead>
<tr>
<th style="text-align:left">Flag</th>
<th style="text-align:left">Value</th>
<th style="text-align:left">Function</th>
<th style="text-align:left">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong><code>--seed-max-desert</code></strong></td>
<td style="text-align:left">Default: 900</td>
<td style="text-align:left">Maximum length of distances between seeds</td>
<td style="text-align:left">The default value of 900 guarantees queries &gt;900 bp would match at least one seed. ► Smaller values improve the search sensitivity and slightly increase the index size. ►Large regions with no seeds are called sketching deserts. Deserts with seed distance larger than this value will be filled by choosing k-mers roughly every <code>--seed-in-desert-dist</code> (200 by default) bases.</td>
</tr>
<tr>
<td style="text-align:left"><code>-c/--chunks</code></td>
<td style="text-align:left">Maximum: 128, default: #CPUs</td>
<td style="text-align:left">Number of seed file chunks</td>
<td style="text-align:left">Bigger values accelerate the search speed at the cost of a high disk reading load. The maximum number should not exceed the maximum number of open files set by the operating systems.</td>
</tr>
<tr>
<td style="text-align:left"><code>-p/--partitions</code></td>
<td style="text-align:left">Default: 512</td>
<td style="text-align:left">Number of partitions for indexing each seed file</td>
<td style="text-align:left">Bigger values bring a little higher memory occupation. 512 is a good value with high searching speed, larger or smaller values would decrease the speed in <code>lexicmap search</code>. ► After indexing, <code>lexicmap utils reindex-seeds</code> can be used to reindex the seeds data with  another value of this flag.</td>
</tr>
<tr>
<td style="text-align:left"><code>--max-open-files</code></td>
<td style="text-align:left">Default: 512</td>
<td style="text-align:left">Maximum number of open files</td>
<td style="text-align:left">It&rsquo;s only used in merging indexes of multiple genome batches.</td>
</tr>
</tbody>
</table> </div>

    </div>
</div>

<p>Also see the <a
  class="gdoc-markdown__link"
  href="https://bioinf.shenwei.me/LexicMap/usage/#index"
>usage</a> of <code>lexicmap index</code>.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="steps"
    >
        Steps
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#steps" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Steps" aria-label="Anchor to: Steps" href="#steps">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>We use a small dataset for demonstration.</p>
<ol>
<li>
<p>Preparing the test genomes (15 bacterial genomes) in the <code>refs</code> directory.</p>
<p>Note that the genome files contain the assembly accessions (ID) in the file names.</p>
<pre><code> git clone https://github.com/shenwei356/LexicMap
 cd LexicMap/demo/

 ls refs/
 GCF_000006945.2.fa.gz  GCF_000392875.1.fa.gz  GCF_001096185.1.fa.gz  GCF_002949675.1.fa.gz  GCF_006742205.1.fa.gz
 GCF_000017205.1.fa.gz  GCF_000742135.1.fa.gz  GCF_001457655.1.fa.gz  GCF_002950215.1.fa.gz  GCF_009759685.1.fa.gz
 GCF_000148585.2.fa.gz  GCF_001027105.1.fa.gz  GCF_001544255.1.fa.gz  GCF_003697165.2.fa.gz  GCF_900638025.1.fa.gz
</code></pre>
</li>
<li>
<p>Building an index with genomes from <strong>a directory</strong>.</p>
<pre><code> lexicmap index -I refs/ -O demo.lmi
</code></pre>
<p>It would take about 2 seconds and 2 GB RAM in a 16-CPU PC.</p>
<p>Optionally, we can also use <strong>a file list</strong> as the input.</p>
<pre><code> $ head -n 3 files.txt
 refs/GCF_000006945.2.fa.gz
 refs/GCF_000017205.1.fa.gz
 refs/GCF_000148585.2.fa.gz

 lexicmap index -X files.txt -O demo.lmi
</code></pre>
</li>
</ol>

<div class="gdoc-expand">
  <label class="gdoc-expand__head flex justify-between" for="4aa51d0a-3">
    <span>Click to show the log of a demo run.</span>
    <span>...</span>
  </label>
  <input id="4aa51d0a-3" type="checkbox" class="gdoc-expand__control hidden" />
  <div class="gdoc-markdown--nested gdoc-expand__content">
    <pre><code># here we set a small --batch-size 5
$ lexicmap index -I refs/ -O demo.lmi --batch-size 5
20:24:16.138 [INFO] LexicMap v0.4.0
20:24:16.138 [INFO]   https://github.com/shenwei356/LexicMap
20:24:16.138 [INFO]
20:24:16.138 [INFO] checking input files ...
20:24:16.138 [INFO]   15 input file(s) given
20:24:16.138 [INFO]
20:24:16.138 [INFO] --------------------- [ main parameters ] ---------------------
20:24:16.138 [INFO]
20:24:16.138 [INFO] input and output:
20:24:16.138 [INFO]   input directory: refs/
20:24:16.138 [INFO]     regular expression of input files: (?i)\.(f[aq](st[aq])?|fna)(.gz)?$
20:24:16.138 [INFO]     *regular expression for extracting reference name from file name: (?i)(.+)\.(f[aq](st[aq])?|fna)(.gz)?$
20:24:16.138 [INFO]     *regular expressions for filtering out sequences: []
20:24:16.138 [INFO]   max genome size: 15000000
20:24:16.138 [INFO]   output directory: demo.lmi
20:24:16.138 [INFO]
20:24:16.138 [INFO] k-mer size: 31
20:24:16.138 [INFO] number of masks: 40000
20:24:16.138 [INFO] rand seed: 1
20:24:16.138 [INFO] maximum sketching desert length: 900
20:24:16.138 [INFO] prefix length for checking low-complexity and choosing k-mers to fill sketching deserts: 15
20:24:16.138 [INFO] distance of k-mers to fill deserts: 200
20:24:16.139 [INFO]
20:24:16.139 [INFO]
20:24:16.139 [INFO] seeds data chunks: 16
20:24:16.139 [INFO] seeds data indexing partitions: 512
20:24:16.139 [INFO] genome batch size: 5
20:24:16.139 [INFO]
20:24:16.139 [INFO]
20:24:16.139 [INFO] --------------------- [ generating masks ] ---------------------
20:24:16.448 [INFO]
20:24:16.449 [INFO] --------------------- [ building index ] ---------------------
20:24:16.588 [INFO]
20:24:16.588 [INFO]   ------------------------[ batch 0 ]------------------------
20:24:16.588 [INFO]   building index for batch 0 with 5 files...
processed files:  5 / 5 [======================================] ETA: 0s. done
20:24:17.137 [INFO]   writing seeds...
20:24:17.276 [INFO]   finished writing seeds in 139.057887ms
20:24:17.276 [INFO]   finished building index for batch 0 in: 688.321313ms
20:24:17.276 [INFO]
20:24:17.276 [INFO]   ------------------------[ batch 1 ]------------------------
20:24:17.276 [INFO]   building index for batch 1 with 5 files...
processed files:  5 / 5 [======================================] ETA: 0s. done
20:24:18.533 [INFO]   writing seeds...
20:24:18.711 [INFO]   finished writing seeds in 178.082436ms
20:24:18.711 [INFO]   finished building index for batch 1 in: 1.435404512s
20:24:18.711 [INFO]
20:24:18.711 [INFO]   ------------------------[ batch 2 ]------------------------
20:24:18.711 [INFO]   building index for batch 2 with 5 files...
processed files:  5 / 5 [======================================] ETA: 0s. done
20:24:19.428 [INFO]   writing seeds...
20:24:19.608 [INFO]   finished writing seeds in 179.258899ms
20:24:19.608 [INFO]   finished building index for batch 2 in: 896.434874ms
20:24:19.608 [INFO]
20:24:19.608 [INFO] merging 3 indexes...
20:24:19.608 [INFO]   [round 1]
20:24:19.608 [INFO]     batch 1/1, merging 3 indexes to demo.lmi.tmp/r1_b1
20:24:20.173 [INFO]   [round 1] finished in 565.004912ms
20:24:20.173 [INFO] rename demo.lmi.tmp/r1_b1 to demo.lmi
20:24:20.178 [INFO]
20:24:20.178 [INFO] finished building LexicMap index from 15 files with 40000 masks in 4.039522685s
20:24:20.178 [INFO] LexicMap index saved: demo.lmi
20:24:20.178 [INFO]
20:24:20.178 [INFO] elapsed time: 4.039558932s
20:24:20.178 [INFO]
</code></pre>

  </div>
</div>

<div class="flex align-center gdoc-page__anchorwrap">
    <h2 id="output"
    >
        Output
    </h2>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#output" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Output" aria-label="Anchor to: Output" href="#output">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<p>The LexicMap index is a directory with multiple files.</p>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="file-structure"
    >
        File structure
    </h3>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#file-structure" class="gdoc-page__anchor clip flex align-center" title="Anchor to: File structure" aria-label="Anchor to: File structure" href="#file-structure">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>
<pre><code>$ tree demo.lmi/
demo.lmi/                    # the index directory
├── genomes                  # directory of genome data
│   └── batch_0000           # genome data of a batch
│       ├── genomes.bin      # genome data file, containing genome ID, size, sequence lengths, bit-packed sequences
│       └── genomes.bin.idx  # index of genome data file, for fast subsequence extraction
├── seeds                    # seed data: pairs of k-mer and its location information (genome batch, genome number, location, strand)
│   ├── chunk_000.bin        # seed data file
│   ├── chunk_000.bin.idx    # index of seed data file, for fast seed searching and data extraction
... ... ...
│   ├── chunk_015.bin        # the number of chunks is set by flag `-c/--chunks`, default: #cpus
│   └── chunk_015.bin.idx
├── genomes.map.bin          # mapping genome ID to batch number of genome number in the batch
├── info.toml                # summary of the index
├── masks.bin                # mask data
</code></pre>
<div class="flex align-center gdoc-page__anchorwrap">
    <h3 id="index-size"
    >
        Index size
    </h3>
    <a data-clipboard-text="https://bioinf.shenwei.me/LexicMap/tutorials/index/#index-size" class="gdoc-page__anchor clip flex align-center" title="Anchor to: Index size" aria-label="Anchor to: Index size" href="#index-size">
        <svg class="gdoc-icon gdoc_link"><use xlink:href="#gdoc_link"></use></svg>
    </a>
</div>



<div class="gdoc-tabs">
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t2"
      id="tabs-t2-0"
      checked="checked"
    />
    <label for="tabs-t2-0" class="gdoc-tabs__label">
      Demo data
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <pre><code># 15 genomes
$ dirsize demo.lmi/
demo.lmi/: 26.90 MB
  13.67 MB      seeds
  12.93 MB      genomes
 312.53 KB      masks.bin
  375.00 B      genomes.map.bin
  261.00 B      info.toml
</code></pre>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t2"
      id="tabs-t2-1"
      
    />
    <label for="tabs-t2-1" class="gdoc-tabs__label">
      GTDB repr
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <pre><code># 85,205 genomes
gtdb_repr.lmi: 110.37 GB
  66.78 GB      genomes
  43.59 GB      seeds
   2.03 MB      genomes.map.bin
 312.53 KB      masks.bin
  266.00 B      info.toml
</code></pre>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t2"
      id="tabs-t2-2"
      
    />
    <label for="tabs-t2-2" class="gdoc-tabs__label">
      GTDB complete
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <pre><code># 402,538 genomes
gtdb_complete.lmi: 506.57 GB
 362.99 GB      genomes
 143.57 GB      seeds
   9.60 MB      genomes.map.bin
 312.53 KB      masks.bin
  269.00 B      info.toml
</code></pre>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t2"
      id="tabs-t2-3"
      
    />
    <label for="tabs-t2-3" class="gdoc-tabs__label">
      Genbank&#43;RefSeq
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <pre><code># 2,340,672 genomes
genbank_refseq.lmi: 2.90 TB
   2.17 TB      genomes
 754.04 GB      seeds
  55.81 MB      genomes.map.bin
 312.53 KB      masks.bin
  271.00 B      info.toml
</code></pre>

    </div>
    <input
      type="radio"
      class="gdoc-tabs__control hidden"
      name="tabs-t2"
      id="tabs-t2-4"
      
    />
    <label for="tabs-t2-4" class="gdoc-tabs__label">
      AllTheBacteria HQ
    </label>
    <div class="gdoc-markdown--nested gdoc-tabs__content">
      <pre><code># 1,858,610 genomes
2kk-HQ.lmi: 2.32 TB
   1.77 TB      genomes
 563.16 GB      seeds
  39.22 MB      genomes.map.bin
 312.53 KB      masks.bin
  271.00 B      info.toml
</code></pre>

    </div>
</div>

<ul>
<li>Directory/file sizes are counted with <a
  class="gdoc-markdown__link"
  href="https://github.com/shenwei356/dirsize"
>https://github.com/shenwei356/dirsize</a>.</li>
<li>Index building parameters: <code>-k 31 -m 40000</code>. Genome batch size: <code>-b 10000</code> for GTDB datasets, <code>-b 50000</code> for others.</li>
</ul>
<p><strong>What&rsquo;s next:</strong> 


<span class="gdoc-button gdoc-button--regular">
  <a
    class="gdoc-button__link" href="/LexicMap/tutorials/search/"
  >
    Searching
  </a>
</span>
</p>

  </article>



          
          
          <div class="gdoc-page__footer flex flex-wrap justify-between">
            
              








  
  

  
  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        

        
        
          
  
  

  
  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        
          
          
        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        
          
            
            
          
        

        

        
          
        

        
        
      
    

  

        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        

        
        
          
  
  

  
  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
          
  
  

  
  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  

        
      
    

  

        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        

        
        
          
  
  

  
  
    

    
      
    

    
      
      

      
        
        
        
        

        
        

        

        

        
          
        

        
        
      
    

  

        
      
    

  




<span class="gdoc-page__nav">
  
    <a
      class="gdoc-page__nav--prev flex align-center"
      href="/LexicMap/releases/"
      title="Releases"
    >
      <i class="gdoc-icon">gdoc_arrow_left_alt</i>
      Releases
    </a>
  
</span>
<span class="gdoc-page__nav">
  
    <a
      class="gdoc-page__nav--next flex align-center"
      href="/LexicMap/tutorials/search/"
      title="Searching"
    >
      Searching
      <i class="gdoc-icon">gdoc_arrow_right_alt</i>
    </a>
  
</span>

            
          </div>
          
        </div>
      </main>

      <footer class="gdoc-footer">
  <nav class="container flex">
    <div>
      <section class="flex flex-wrap align-center">
        <span class="gdoc-footer__item gdoc-footer__item--row">
          Built with <a href="https://gohugo.io/" class="gdoc-footer__link">Hugo</a> and <svg class="gdoc-icon gdoc_heart"><use xlink:href="#gdoc_heart"></use></svg>

        </span>
        
        
      </section>
      
    </div>
    
      <div class="flex flex-25 justify-end">
        <span class="gdoc-footer__item text-right">
          <a class="gdoc-footer__link fake-link" href="#" aria-label="Back to top">
            <svg class="gdoc-icon gdoc_keyboard_arrow_up">
              <use xlink:href="#gdoc_keyboard_arrow_up"></use>
            </svg>
            <span class="hidden-mobile">Back to top</span>
          </a>
        </span>
      </div>
    
  </nav>
</footer>

    </div>

    
  <script defer src="/LexicMap/js/search-95c697e2.bundle.min.js"></script>

  </body>
</html>
