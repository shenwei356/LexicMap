<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>More on LexicMap: efficient sequence alignment against millions of prokaryotic genomes​</title>
    <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/</link>
    <description>Recent content in More on LexicMap: efficient sequence alignment against millions of prokaryotic genomes​</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <atom:link href="https://bioinf.shenwei.me/LexicMap/tutorials/misc/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Indexing GTDB</title>
      <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-gtdb/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-gtdb/</guid>
      <description>&lt;p&gt;Info:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://gtdb.ecogenomic.org/&#34;&#xA;&gt;https://gtdb.ecogenomic.org/&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tools:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/pirovc/genome_updater&#34;&#xA;&gt;https://github.com/pirovc/genome_updater&lt;/a&gt;, for downloading genomes&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/seqkit&#34;&#xA;&gt;https://github.com/shenwei356/seqkit&lt;/a&gt;, for checking sequence files&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/rush&#34;&#xA;&gt;https://github.com/shenwei356/rush&lt;/a&gt;, for running jobs&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/sharkdp/fd&#34;&#xA;&gt;https://github.com/sharkdp/fd&lt;/a&gt;, faster &lt;code&gt;find&lt;/code&gt;, available as &lt;code&gt;fd-find&lt;/code&gt; in &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://anaconda.org/conda-forge/fd-find&#34;&#xA;&gt;conda-forge&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;time genome_updater.sh -d &amp;quot;refseq,genbank&amp;quot; -g &amp;quot;archaea,bacteria&amp;quot; \&#xA;    -f &amp;quot;genomic.fna.gz&amp;quot; -o &amp;quot;GTDB_complete&amp;quot; -M &amp;quot;gtdb&amp;quot; -t 12 -a -m -L curl&#xA;&#xA;cd GTDB_complete/2024-01-30_19-34-40/&#xA;&#xA;&#xA;# ----------------- check the file integrity -----------------&#xA;&#xA;genomes=files&#xA;&#xA;# corrupted files&#xA;# find $genomes -name &amp;quot;*.gz&amp;quot; \&#xA;fd &amp;quot;.gz$&amp;quot; $genomes \&#xA;    | rush --eta &#39;seqkit seq -w 0 {} &amp;gt; /dev/null; if [ $? -ne 0 ]; then echo {}; exit 1; fi&#39; \&#xA;        -c -C check-files.rush \&#xA;    &amp;gt; failed.txt&#xA;&#xA;# empty files&#xA;# find $genomes -name &amp;quot;*.gz&amp;quot; -size 0 &amp;gt;&amp;gt; failed.txt&#xA;fd --size 0b $genomes &amp;gt;&amp;gt; failed.txt&#xA;&#xA;# delete these files&#xA;cat failed.txt | rush &#39;/bin/rm {}&#39;&#xA;&#xA;# redownload them:&#xA;# run the genome_updater command again, with the flag -i&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Taxonomy data to limit TaxId in &lt;code&gt;lexicmap search&lt;/code&gt; since LexicMap v0.8.0.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Indexing GenBank&#43;RefSeq</title>
      <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-genbank/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-genbank/</guid>
      <description>&lt;p&gt;&lt;strong&gt;Make sure you have enough disk space, &amp;gt;10 TB is preferred.&lt;/strong&gt;&lt;/p&gt;&#xA;&lt;p&gt;Tools:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/pirovc/genome_updater&#34;&#xA;&gt;https://github.com/pirovc/genome_updater&lt;/a&gt;, for downloading genomes&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/seqkit&#34;&#xA;&gt;https://github.com/shenwei356/seqkit&lt;/a&gt;, for checking sequence files&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/rush&#34;&#xA;&gt;https://github.com/shenwei356/rush&lt;/a&gt;, for running jobs&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/sharkdp/fd&#34;&#xA;&gt;https://github.com/sharkdp/fd&lt;/a&gt;, faster &lt;code&gt;find&lt;/code&gt;, available as &lt;code&gt;fd-find&lt;/code&gt; in &lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://anaconda.org/conda-forge/fd-find&#34;&#xA;&gt;conda-forge&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;time genome_updater.sh -d &amp;quot;refseq,genbank&amp;quot; -g &amp;quot;archaea,bacteria&amp;quot; \&#xA;    -f &amp;quot;genomic.fna.gz&amp;quot; -o &amp;quot;genbank&amp;quot; -M &amp;quot;ncbi&amp;quot; -t 12 -a -m -L curl&#xA;&#xA;cd genbank/2024-02-15_11-00-51/&#xA;&#xA;&#xA;# ----------------- check the file integrity -----------------&#xA;&#xA;genomes=files&#xA;&#xA;# corrupted files&#xA;# find $genomes -name &amp;quot;*.gz&amp;quot; \&#xA;fd &amp;quot;.gz$&amp;quot; $genomes \&#xA;    | rush --eta &#39;seqkit seq -w 0 {} &amp;gt; /dev/null; if [ $? -ne 0 ]; then echo {}; exit 1; fi&#39; \&#xA;        -c -C check-files.rush \&#xA;    &amp;gt; failed.txt&#xA;&#xA;# empty files&#xA;# find $genomes -name &amp;quot;*.gz&amp;quot; -size 0 &amp;gt;&amp;gt; failed.txt&#xA;fd --size 0b $genomes &amp;gt;&amp;gt; failed.txt&#xA;&#xA;# delete these files&#xA;cat failed.txt | rush &#39;/bin/rm {}&#39;&#xA;&#xA;# redownload them:&#xA;# run the genome_updater command again, with the flag -i&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Taxonomy data to limit TaxId in &lt;code&gt;lexicmap search&lt;/code&gt; since LexicMap v0.8.0.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Indexing AllTheBacteria</title>
      <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-allthebacteria/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-allthebacteria/</guid>
      <description>&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h2 id=&#34;table-of-contents&#34;&#xA;    &gt;&#xA;        Table of contents&#xA;    &lt;/h2&gt;&#xA;    &lt;a data-clipboard-text=&#34;https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-allthebacteria/#table-of-contents&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Table of contents&#34; aria-label=&#34;Anchor to: Table of contents&#34; href=&#34;#table-of-contents&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;gdoc-toc gdoc-toc__level--3&#34;&gt;&#xA;      &lt;nav id=&#34;TableOfContents&#34;&gt;&#xA;  &lt;ul&gt;&#xA;    &lt;li&gt;&#xA;      &lt;ul&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#table-of-contents&#34;&gt;Table of contents&lt;/a&gt;&lt;/li&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#searching-with-the-pre-built-index-on-aws&#34;&gt;Searching with the pre-built index on AWS&lt;/a&gt;&#xA;          &lt;ul&gt;&#xA;            &lt;li&gt;&lt;a href=&#34;#run-on-ec2&#34;&gt;Run on EC2&lt;/a&gt;&lt;/li&gt;&#xA;            &lt;li&gt;&lt;a href=&#34;#only-download-it-and-run-locally&#34;&gt;Only download it and run locally&lt;/a&gt;&lt;/li&gt;&#xA;          &lt;/ul&gt;&#xA;        &lt;/li&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#steps-for-v02-and-later-versions-hosted-at-osf&#34;&gt;Steps for v0.2 and later versions hosted at OSF&lt;/a&gt;&lt;/li&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#steps-for-v02-hosted-at-ebi-ftp&#34;&gt;Steps for v0.2 hosted at EBI ftp&lt;/a&gt;&lt;/li&gt;&#xA;      &lt;/ul&gt;&#xA;    &lt;/li&gt;&#xA;  &lt;/ul&gt;&#xA;&lt;/nav&gt;&#xA;      &lt;hr /&gt;&#xA;    &lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h2 id=&#34;searching-with-the-pre-built-index-on-aws&#34;&#xA;    &gt;&#xA;        Searching with the pre-built index on AWS&#xA;    &lt;/h2&gt;&#xA;    &lt;a data-clipboard-text=&#34;https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-allthebacteria/#searching-with-the-pre-built-index-on-aws&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Searching with the pre-built index on AWS&#34; aria-label=&#34;Anchor to: Searching with the pre-built index on AWS&#34; href=&#34;#searching-with-the-pre-built-index-on-aws&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;div class=&#34;flex align-center gdoc-page__anchorwrap&#34;&gt;&#xA;    &lt;h3 id=&#34;run-on-ec2&#34;&#xA;    &gt;&#xA;        Run on EC2&#xA;    &lt;/h3&gt;&#xA;    &lt;a data-clipboard-text=&#34;https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-allthebacteria/#run-on-ec2&#34; class=&#34;gdoc-page__anchor clip flex align-center&#34; title=&#34;Anchor to: Run on EC2&#34; aria-label=&#34;Anchor to: Run on EC2&#34; href=&#34;#run-on-ec2&#34;&gt;&#xA;        &lt;svg class=&#34;gdoc-icon gdoc_link&#34;&gt;&lt;use xlink:href=&#34;#gdoc_link&#34;&gt;&lt;/use&gt;&lt;/svg&gt;&#xA;    &lt;/a&gt;&#xA;&lt;/div&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/LaunchingAndUsingInstances.html&#34;&#xA;&gt;Launch an EC2 instance&lt;/a&gt;&#xA;&lt;strong&gt;in Europe London region (eu-west-2)&lt;/strong&gt; where the index is located.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Indexing GlobDB</title>
      <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-globdb/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-globdb/</guid>
      <description>&lt;p&gt;Info:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://globdb.org/&#34;&#xA;&gt;GlobDB&lt;/a&gt; , a dereplicated dataset of the species reps of the GTDB, GEM, SPIRE and SMAG datasets a lot.&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://x.com/daanspeth/status/1822964436950192218&#34;&#xA;&gt;https://x.com/daanspeth/status/1822964436950192218&lt;/a&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# check the latest version here: https://fileshare.lisc.univie.ac.at/globdb/&#xA;&#xA;# download data&#xA;wget https://fileshare.lisc.univie.ac.at/globdb/globdb_r220/globdb_r220_genome_fasta.tar.gz&#xA;&#xA;tar -zxf globdb_r220_genome_fasta.tar.gz&#xA;&#xA;# file list&#xA;find globdb_r220_genome_fasta/ -name &amp;quot;*.fa.gz&amp;quot; &amp;gt; files.txt&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Taxonomy data to limit TaxId in &lt;code&gt;lexicmap search&lt;/code&gt; since LexicMap v0.8.0.&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;wget https://fileshare.lisc.univie.ac.at/globdb/globdb_r220/globdb_r220_tax.tsv&#xA;&#xA;# Create taxdump files with TaxonKit: https://bioinf.shenwei.me/taxonkit/usage/#create-taxdump    &#xA;taxonkit create-taxdump -A 1 -R superkingdom,phylum,class,order,family,genus,species globdb_r220_tax.tsv -O taxdump&#xA;&#xA;# It has a file mapping assembly accession to TaxId&#xA;ln -s taxdump/taxid.map&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Indexing with LexicMap&lt;/p&gt;</description>
    </item>
    <item>
      <title>Indexing UHGG</title>
      <link>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-uhgg/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      <guid>https://bioinf.shenwei.me/LexicMap/tutorials/misc/index-uhgg/</guid>
      <description>&lt;p&gt;Info:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://www.ebi.ac.uk/metagenomics/genome-catalogues/human-gut-v2-0-2&#34;&#xA;&gt;Unified Human Gastrointestinal Genome (UHGG) v2.0.2&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://www.nature.com/articles/s41587-020-0603-3&#34;&#xA;&gt;A unified catalog of 204,938 reference genomes from the human gut microbiome&lt;/a&gt;&lt;/li&gt;&#xA;&lt;li&gt;Number of Genomes: 289,232&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Tools:&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/seqkit&#34;&#xA;&gt;https://github.com/shenwei356/seqkit&lt;/a&gt;, for checking sequence files&lt;/li&gt;&#xA;&lt;li&gt;&lt;a&#xA;  class=&#34;gdoc-markdown__link&#34;&#xA;  href=&#34;https://github.com/shenwei356/rush&#34;&#xA;&gt;https://github.com/shenwei356/rush&lt;/a&gt;, for running jobs&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;Data:&lt;/p&gt;&#xA;&lt;pre&gt;&lt;code&gt;# meta data&#xA;wget https://ftp.ebi.ac.uk/pub/databases/metagenomics/mgnify_genomes/human-gut/v2.0.2/genomes-all_metadata.tsv&#xA;&#xA;# gff url&#xA;sed 1d genomes-all_metadata.tsv | cut -f 20  | sed &#39;s/v2.0/v2.0.2/&#39; | sed -E &#39;s/^ftp/https/&#39; &amp;gt; url.txt&#xA;&#xA;# download gff files&#xA;mkdir -p files; cd files&#xA;&#xA;time cat ../url.txt \&#xA;    | rush --eta -v &#39;dir={///%}/{//%}&#39; \&#xA;        &#39;mkdir -p {dir}; curl -s -o {dir}/{%} {}&#39; \&#xA;        -c -C download.rush -j 12&#xA;cd ..&#xA;&#xA;# extract sequences from gff files&#xA;find files/ -name &amp;quot;*.gff.gz&amp;quot; \&#xA;    | rush --eta \&#xA;        &#39;zcat {} | perl -ne &amp;quot;print if \$s; \$s=true if /^##FASTA/&amp;quot; | seqkit seq -w 0 -o {/}/{%:}.fna.gz&#39; \&#xA;        -c -C extract.rush&#xA;&lt;/code&gt;&lt;/pre&gt;&#xA;&lt;p&gt;Indexing. On a 48-CPU machine, time: 3 h, ram: 41 GB, index size: 426 GB.&#xA;If you don&amp;rsquo;t have enough memory, please decrease the value of &lt;code&gt;-b&lt;/code&gt;.&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
