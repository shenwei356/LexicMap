[{"id":0,"href":"/LexicMap/usage/index/","title":"index","parent":"Usage","content":"$ lexicmap index -h Generate an index from FASTA/Q sequences Input: *1. Sequences of each reference genome should be saved in separate FASTA/Q files, with reference identifiers in the file names. 2. Input plain or gzipped FASTA/Q files can be given via positional arguments or the flag -X/--infile-list with the list of input files. 3. Input can also be a directory containing sequence files via the flag -I/--in-dir, with multiple-level sub-directories allowed. A regular expression for matching sequencing files is available via the flag -r/--file-regexp. 4. Some none-isolate assemblies might have extremely large genomes (e.g., GCA_000765055.1, \u0026gt;150 mb). The flag -g/--max-genome is used to skip these input files, and the file list would be written to a file (-G/--big-genomes). Attention: *1) ► You can rename the sequence files for convenience because the genome identifiers in the index and search result would be: the basenames of files with common FASTA/Q file extensions removed, which are extracted via the flag -N/--ref-name-regexp. ► The extracted genome identifiers better be distinct/unique, which will be shown in search results and are used to extract subsequences in the command \u0026#34;lexicmap utils subseq\u0026#34;. 2) ► Unwanted sequences like plasmids can be filtered out by the name via regular expressions (-B/--seq-name-filter). Important parameters: --- LexicHash mask generation --- 0. -M/--mask-file, ► File with custom masks, which could be generated by \u0026#34;lexicmap utils gen-masks\u0026#34;. This flag oversides -k/--kmer, -m/--masks, -s/--rand-seed, -n/--top-n, and -P/--prefix-ext. 1. -k/--kmer, ► K-mer size (maximum: 32, default: 31). ► Bigger values improve the search specificity and do not increase the index size. 2. -m/--masks, ► Number of masks (default: 40000). ► Bigger values improve the search sensitivity and increase the index size. 3. -n/--top-n, ► The top N largest genomes for generating mask (default 20). ► Bigger values increase the indexing memory occupation (1.0~1.5 GB per genome for 20k masks). 4. -P/--prefix-ext, ► Extension length of prefixes (default 8). ► Bigger values improve the search sensitivity by decreasing the maximum seed distances. --- seeds (k-mer-value data) --- 1. -c/--chunks, ► Number of seed file chunks (maximum: 128, default: #CPUs). ► Bigger values accelerate the search speed at the cost of a high disk reading load. The maximum number should not exceed the maximum number of open files set by the operating systems. 2. -p/--partitions, ► Number of partitions for indexing each seed file (default: 512). ► Bigger values bring higher memory occupation. 512 is a good value with high searching speed, Larger or smaller values would decrease the speed in \u0026#34;lexicmap search\u0026#34;. ► After indexing, \u0026#34;lexicmap utils reindex-seeds\u0026#34; can be used to reindex the seeds data with another value of this flag. 3. --max-open-files, ► Maximum number of open files (default: 512). ► It\u0026#39;s only used in merging indexes of multiple genome batches. --- genome data --- 1. -b/--batch-size, ► Maximum number of genomes in each batch (maximum: 131072, default: 10000). ► If the number of input files exceeds this number, input files are into multiple batches and indexes are built for all batches. Next, seed files are merged into a big one, while genome data files are kept unchanged and collected. ► Bigger values increase indexing memory occupation, while improving the search speed. Usage: lexicmap index [flags] [-k \u0026lt;k\u0026gt;] [-m \u0026lt;masks\u0026gt;] { -I \u0026lt;seqs dir\u0026gt; | -X \u0026lt;file list\u0026gt;} -O \u0026lt;out dir\u0026gt; Flags: -b, --batch-size int ► Maximum number of genomes in each batch (maximum value: 131072) (default 10000) -G, --big-genomes string ► Out file of skipped files with genomes \u0026gt;= -G/--max-genome -c, --chunks int ► Number of chunks for storing seeds (k-mer-value data) files. (default 16) -r, --file-regexp string ► Regular expression for matching sequence files in -I/--in-dir, case ignored. (default \u0026#34;\\\\.(f[aq](st[aq])?|fna)(.gz)?$\u0026#34;) --force ► Overwrite existing output directory. -h, --help help for index -I, --in-dir string ► Directory containing FASTA/Q files. Directory symlinks are followed. -k, --kmer int ► Maximum k-mer size. K needs to be \u0026lt;= 32. (default 31) -M, --mask-file string ► File of custom masks. This flag oversides -k/--kmer, -m/--masks, -s/--rand-seed, --prefix, -n/--top-n, and -P/--prefix-ext. -m, --masks int ► Number of masks. (default 40000) -g, --max-genome int ► Maximum genome size. Extremely large genomes (non-isolate assemblies) will be skipped. (default 15000000) --max-open-files int ► Maximum opened files, used in merging indexes. (default 512) -O, --out-dir string ► Output directory. -p, --partitions int ► Number of partitions for indexing seeds (k-mer-value data) files. (default 512) -P, --prefix-ext int ► Extension length of prefixes, higher values -\u0026gt; smaller maximum seed distances. (default 8) -s, --rand-seed int ► Rand seed for generating random masks. (default 1) -N, --ref-name-regexp string ► Regular expression (must contains \u0026#34;(\u0026#34; and \u0026#34;)\u0026#34;) for extracting the reference name from the filename. (default \u0026#34;(?i)(.+)\\\\.(f[aq](st[aq])?|fna)(.gz)?$\u0026#34;) --save-seed-pos ► Save seed positions, which can be inspect with \u0026#34;lexicmap utils seed-positions\u0026#34;. -B, --seq-name-filter strings ► List of regular expressions for filtering out sequences by header/name, case ignored. -n, --top-n int ► Select the top N largest genomes for generating masks. (default 20) Examples See Building an index ","description":"$ lexicmap index -h Generate an index from FASTA/Q sequences Input: *1. Sequences of each reference genome should be saved in separate FASTA/Q files, with reference identifiers in the file names. 2. Input plain or gzipped FASTA/Q files can be given via positional arguments or the flag -X/--infile-list with the list of input files. 3. Input can also be a directory containing sequence files via the flag -I/--in-dir, with multiple-level sub-directories allowed."},{"id":1,"href":"/LexicMap/introduction/","title":"Introduction","parent":"","content":"LexicMap is a sequence alignment tool aiming to efficiently query gene or plasmid sequences against up to millions of prokaryotic genomes.\nFor example, querying a 51.5-kb plasmid in all 2,340,672 Genbank+Refseq prokaryotic genomes takes only 3 minutes and 32 seconds with 15.7 GB RAM and 48 CPUs, with 19,265 genome hits returned. By contrast, BLASTN is unable to run with the same dataset on common servers because it requires \u0026gt;2000 GB RAM. See performance.\nLexicMap uses a modified LexicHash algorithm, which supports variable-length substring matching rather than classical fixed-length k-mers matching, to compute seeds for sequence alignment and uses multiple-level storage for fast and low-memory quering of seeds data. See algorithm overview.\nLexicMap is also very easy to install (a binary file with no dependencies) and use (tutorials and usages).\nPerformance GTDB repr Index information dataset genomes gzip_size db_size indexing_time indexing_RAM GTDB repr 85,205 75 GB 110 GB 1 h 25 m 49 GB Query performance query query_len genome_hits time RAM a MutL gene 1,956 bp 2 0.9 s 460 MB a 16S rRNA gene 1,542 bp 13,466 4.0 s 765 MB a plasmid 51,466 bp 2 1.1 s 752 MB GTDB complete Index information dataset genomes gzip_size db_size indexing_time indexing_RAM GTDB complete 402,538 578 GB 507 GB 5 h 18 m 46 GB Query performance query query_len genome_hits time RAM a MutL gene 1,956 bp 268 3.8 s 544 MB a 16S rRNA gene 1,542 bp 169,480 2 m 14 s 2.9 GB a plasmid 51,466 bp 3,649 56 s 2.9 GB Genbank\u0026#43;RefSeq Index information dataset genomes gzip_size db_size indexing_time indexing_RAM Genbank+RefSeq 2,340,672 3.5 TB 2.9 TB 31 h 19 m 148 GB Query performance query query_len genome_hits time RAM a MutL gene 1,956 bp 817 10.0 s 2.3 GB a 16S rRNA gene 1,542 bp 1,148,049 5 m 34 s 11.8 GB a plasmid 51,466 bp 19,265 3 m 32 s 15.7 GB AllTheBacteria HQ Index information dataset genomes gzip_size db_size indexing_time indexing_RAM AllTheBacteria HQ 1,858,610 3.1 TB 2.4 TB 16 h 24 m 70 GB Query performance query query_len genome_hits time RAM a MutL gene 1,956 bp 404 18.7 s 2.4 GB a 16S rRNA gene 1,542 bp 1,193,874 13 m 8 s 9.4 GB a plasmid 51,466 bp 10,954 5 m 25 s 9.7 GB Notes:\nAll files are stored on a server with HDD disks. Tests are performed in a single cluster node with 48 CPU cores (Intel Xeon Gold 6336Y CPU @ 2.40 GHz). Index building parameters: -k 31 -m 40000. Genome batch size: -b 10000 for GTDB datasets, -b 131072 for others. Algorithm overview Related projects High-performance LexicHash computation in Go. Support Please open an issue to report bugs, propose new functions or ask for help.\nLicense MIT License\n","description":"LexicMap is a sequence alignment tool aiming to efficiently query gene or plasmid sequences against up to millions of prokaryotic genomes.\nFor example, querying a 51.5-kb plasmid in all 2,340,672 Genbank+Refseq prokaryotic genomes takes only 3 minutes and 32 seconds with 15.7 GB RAM and 48 CPUs, with 19,265 genome hits returned. By contrast, BLASTN is unable to run with the same dataset on common servers because it requires \u0026gt;2000 GB RAM."},{"id":2,"href":"/LexicMap/usage/utils/kmers/","title":"kmers","parent":"utils","content":"$ lexicmap utils kmers -h View k-mers captured by the masks Attentions: 1. Mask index (column mask) is 1-based. 2. K-mer positions (column pos) are 1-based. For reference genomes with multiple sequences, the sequences were concatenated to a single sequence with intervals of N\u0026#39;s. Usage: lexicmap utils kmers [flags] -d \u0026lt;index path\u0026gt; [-m \u0026lt;mask index\u0026gt;] [-o out.tsv.gz] Flags: -h, --help help for kmers -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -m, --mask int ► View k-mers captured by Xth mask. (0 for all) (default 1) -o, --out-file string ► Out file, supports and recommends a \u0026#34;.gz\u0026#34; suffix (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples The default output is captured k-mers of the first mask.\n$ lexicmap utils kmers --quiet -d demo.lmi/ | csvtk pretty -t mask kmer number ref pos strand ---- ------------------------------- ------ --------------- ------- ------ 1 AAAAAAACGTAATTGTGTGGGTACAGATTGG 1 GCF_000148585.2 1175190 + 1 AAAAAAACGTCAATCAATTTGACCGCACTTT 1 GCF_900638025.1 774645 + 1 AAAAAAACGTCACAACAACAAGACAAAGTGA 1 GCF_000392875.1 2565649 - 1 AAAAAAACGTCACTTGTCCTTTCCTACCCTT 1 GCF_001457655.1 1711468 + 1 AAAAAAACGTCATAAACCGCAACAGCCGCGC 1 GCF_000742135.1 144039 - 1 AAAAAAACGTCATAACGAATTTCCGGGCGCG 1 GCF_000006945.2 3120524 - 1 AAAAAAACGTCATATCCCAATGGCGATTACT 1 GCF_006742205.1 640624 + 1 AAAAAAACGTCATCGCTTGCATTAGAAAGGT 3 GCF_003697165.2 339475 - 1 AAAAAAACGTCATCGCTTGCATTAGAAAGGT 3 GCF_002949675.1 2873885 + 1 AAAAAAACGTCATCGCTTGCATTAGAAAGGT 3 GCF_002950215.1 2692249 + 1 AAAAAAACGTCATGAAAAACGGCGATTGACA 1 GCF_001544255.1 1283395 - 1 AAAAAAACGTCCATTCTATCAAATCGTTGTG 1 GCF_009759685.1 970548 - 1 AAAAAAACGTCCCAATATTATTGGGACGTTT 1 GCF_001027105.1 2044210 - 1 AAAAAAACGTCGGAGCCACATCTGGCTCTTC 1 GCF_000017205.1 2674197 + 1 AAAAAAACGTCTAGCCAATGACCCATTCCTG 1 GCF_001096185.1 2127010 + Specify the maks.\n$ lexicmap utils kmers --quiet -d demo.lmi/ --mask 12345 | csvtk pretty -t mask kmer number ref pos strand ----- ------------------------------- ------ --------------- ------- ------ 12345 CATGGTGCTTAAAAAAGTAGGGGCAAAGTCC 1 GCF_009759685.1 1468773 + 12345 CATGGTGCTTAACCTCGACAAATGTATCGGT 1 GCF_002949675.1 357987 - 12345 CATGGTGCTTAACCTCGATAAATGTATCGGC 1 GCF_002950215.1 532721 - 12345 CATGGTGCTTAATCGCCGCCTGCGCCGCCAC 1 GCF_000742135.1 3801879 + 12345 CATGGTGCTTACGCAGGTCAGCGGGTATGAC 1 GCF_000006945.2 3792773 - 12345 CATGGTGCTTACGGTGGATCGCGGTCCATTC 1 GCF_000017205.1 383787 - 12345 CATGGTGCTTACTAGTTATGAAATCATCAGT 1 GCF_001457655.1 1887005 - 12345 CATGGTGCTTACTTTACGGTTTTGCTGGCCT 1 GCF_003697165.2 1579125 + 12345 CATGGTGCTTATGCTACGGGTGATGCATTCT 1 GCF_001096185.1 1060887 - 12345 CATGGTGCTTCAACCGAACCAAAATTTTGAA 1 GCF_000392875.1 2836858 + 12345 CATGGTGCTTCATAACCAGGTACTAAACGTT 1 GCF_001027105.1 1305877 - 12345 CATGGTGCTTCATCAAGTGAAAACTCTTATA 1 GCF_000148585.2 456813 - 12345 CATGGTGCTTCGTAACCTGGTACAAGACGTT 1 GCF_006742205.1 1534889 + 12345 CATGGTGCTTGAGGATTGATCAACGGCACTG 1 GCF_001544255.1 1428518 + 12345 CATGGTGCTTGATCATGGAAAATCACTTGTG 1 GCF_900638025.1 468185 + For all masks. The result might be very big, therefore, writing to gzip format is recommended.\n$ lexicmap utils kmers --quiet -d demo.lmi/ --mask 0 -o kmers.tsv.gz The output (TSV format) is formatted with csvtk pretty.\n","description":"$ lexicmap utils kmers -h View k-mers captured by the masks Attentions: 1. Mask index (column mask) is 1-based. 2. K-mer positions (column pos) are 1-based. For reference genomes with multiple sequences, the sequences were concatenated to a single sequence with intervals of N\u0026#39;s. Usage: lexicmap utils kmers [flags] -d \u0026lt;index path\u0026gt; [-m \u0026lt;mask index\u0026gt;] [-o out.tsv.gz] Flags: -h, --help help for kmers -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;."},{"id":3,"href":"/LexicMap/quick-start/","title":"Quick start","parent":"","content":"Installing LexicMap (see installation).\nconda install -c bioconda lexicmap Building an index (see the tutorial of building an index).\n# From a directory with multiple genome files lexicmap index -I genomes/ -O db.lmi # From a file list with one file per line lexicmap index -X files.txt -O db.lmi Querying (see the tutorial of searching).\n# For short queries like genes or long reads, returning top N hits. lexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 70 --min-match-pident 70 --min-qcov-per-hsp 70 --top-n-genomes 500 # For longer queries like plasmids, returning all hits. lexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 50 --min-match-pident 70 --min-qcov-per-hsp 0 --top-n-genomes 0 Sample output (queries are a few Nanopore Q20 reads). See output format details.\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ query qlen qstart qend sgnms sgnm seqid qcovGnm hsp qcovHSP alenHSP alenSeg pident slen sstart send sstr seeds species ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ERR5396170.1000016 740 71 733 1 GCF_013394085.1 NZ_CP040910.1 89.595 1 89.595 663 663 98.492 1887974 13515 14177 + 19 Limosilactobacillus fermentum ERR5396170.1000017 516 27 514 1 GCF_013394085.1 NZ_CP040910.1 94.574 1 94.574 488 488 100.000 1887974 293509 293996 + 6 Limosilactobacillus fermentum ERR5396170.1000029 480 37 474 1 GCF_001027105.1 NZ_CP011526.1 91.042 1 91.042 437 437 95.423 2755072 821078 821514 + 1 Staphylococcus aureus ERR5396170.1000047 960 24 812 2 GCF_001027105.1 NZ_CP011526.1 91.979 1 91.979 883 803 89.015 2755072 2204718 2205520 - 7 Staphylococcus aureus ERR5396170.1000047 960 881 960 2 GCF_001027105.1 NZ_CP011526.1 91.979 1 91.979 883 80 89.015 2755072 2204568 2204647 - 7 Staphylococcus aureus ERR5396170.1000047 960 42 960 2 GCF_002902405.1 NZ_PPQS01000020.1 100.000 1 97.500 936 936 77.457 50421 25900 26835 + 3 Staphylococcus schweitzeri ERR5396170.1000047 960 42 950 2 GCF_002902405.1 NZ_PPQS01000020.1 100.000 2 96.458 926 926 77.214 50421 25900 26825 + 1 Staphylococcus schweitzeri ERR5396170.1000000 698 53 650 1 GCF_001457615.1 NZ_LN831024.1 86.390 1 86.390 603 603 96.517 6316979 4452083 4452685 + 4 Pseudomonas aeruginosa ERR5396170.1000005 2516 38 2510 5 GCF_000006945.2 NC_003197.2 98.490 1 98.490 2478 2478 98.951 4857450 3198806 3201283 + 14 Salmonella enterica ERR5396170.1000005 2516 38 2497 5 GCF_008692785.1 NZ_VXJV01000001.1 98.013 1 98.013 2466 2466 95.864 797633 423400 425865 + 8 Salmonella enterica ERR5396170.1000005 2516 40 2510 5 GCA_900478215.1 LS483478.1 98.450 1 98.450 2477 2477 95.317 4624613 785866 788342 - 12 Salmonella enterica ERR5396170.1000005 2516 1350 2497 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 1151 91.742 366711 6705 7855 + 9 Salmonella enterica ERR5396170.1000005 2516 634 1309 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 674 91.742 366711 5991 6664 + 9 Salmonella enterica ERR5396170.1000005 2516 387 608 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 221 91.742 366711 5745 5965 + 9 Salmonella enterica ERR5396170.1000005 2516 69 205 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 138 91.742 366711 5426 5563 + 9 Salmonella enterica ERR5396170.1000005 2516 306 325 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 20 91.742 366711 5664 5683 + 9 Salmonella enterica ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Note: the column `species` is added by mapping genome ID (column `sgnm`) to taxonomic information. Learn more tutorials and usages.\n","description":"Installing LexicMap (see installation).\nconda install -c bioconda lexicmap Building an index (see the tutorial of building an index).\n# From a directory with multiple genome files lexicmap index -I genomes/ -O db.lmi # From a file list with one file per line lexicmap index -X files.txt -O db.lmi Querying (see the tutorial of searching).\n# For short queries like genes or long reads, returning top N hits. lexicmap search -d db."},{"id":4,"href":"/LexicMap/tutorials/search/","title":"Searching","parent":"Tutorials","content":" Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output Alignment result relationship Output format Examples TL;DR Build or download a LexicMap index.\nRun:\nFor short queries like genes or long reads, returning top N hits.\nlexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 70 --min-match-pident 70 --min-qcov-per-hsp 70 --top-n-genomes 500 For longer queries like plasmids, returning all hits.\nlexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 50 --min-match-pident 70 --min-qcov-per-hsp 0 --top-n-genomes 0 Input Query length\nLexicMap only supports long (\u0026gt;=500 bp) reads or gene/genome/virus/plasmid/phage sequences.\nHowever, some short queries can also be aligned. Input should be (gzipped) FASTA or FASTQ records from files or STDIN.\nHardware requirements LexicMap is designed to provide fast and low-memory sequence alignment against millions of prokaryotic genomes.\nCPU: No specific requirements on CPU type and instruction sets. Both x86 and ARM chips are supported. More is better as LexicMap is a CPU-intensive software. It uses all CPUs by default (-j/--threads). RAM More RAM (\u0026gt; 16 GB) is preferred. The memory usage in searching is mainly related to: The number of matched genomes and sequences. The length of query sequences. Disk Sufficient space is required to store the index size. No temporary files are generated during searching. Algorithm Masking: Query sequence is masked by the masks of the index. In other word, each mask captures the most similar k-mer and stores its posistion and strand information. Seeding: For each mask, the captured k-mer is used to search seeds (captured k-mers in reference genomes) sharing prefixes of at least p bases. Setting the search range: Since the seeded k-mers are stored in lexicographic order, the k-mer matching turns into a range query. For example, for a query CATGCT requiring matching at least 4-bp prefix is equal to extract k-mers ranging from CATGAA, CATGAC, CATGAG, \u0026hellip;, to CATGTT. Finding the nearest offset: The index file of each seed data file stores a list (default 512) of k-mers and offsets in the data file, and the index is Loaded in RAM. The nearest k-mer smaller than the range start k-mer (CATGAA) is found by binary search, i.e., CATCAC (blue text in the fingure), and the offset is returned as the start position in traversing the seed data file. Retrieving seed data: Seed k-mers are read from the file and checked one by one, and k-mers in the search range are returned, along with the k-mer information (genome batch, genome number, location, and strand). Chaining: Seeding results, i.e., anchors (matched k-mers from the query and subject sequence), are summarized by genome, and deduplicated. Performing chaining. Alignment for each chain. Extending the anchor region. for extracting sequences from the query and reference genome. For example, extending 2 kb in upstream and downstream of anchor region. Fast alignment of query and subject sequences. Filtering aligned segments and the whole HSPs (all alignment segments) based on user options. For these HSPs that accross more than one reference sequences, splitting them into multiple HSPs. Parameters Flags in bold text are important and frequently used.\nGeneral Flag Value Function Comment -w/--load-whole-seeds Load the whole seed data into memory for faster search Use this if the index is not big and many queries are needed to search. -n/--top-n-genomes Default 500, 0 for all Keep top N genome matches for a query Chaining Flag Value Function Comment -p, --seed-min-prefix Default 15 Minimum length of shared substrings (anchors). -P, --seed-min-single-prefix Default 20 Minimum length of shared substrings (anchors) if there\u0026rsquo;s only one pair. --seed-max-dist Default 10000 Max distance between seeds in seed chaining. --seed-max-gap Default 2000 Max gap in seed chaining. -m/--seed-max-mismatch Default -1 Minimum mismatch between non-prefix regions of shared substrings. Alignment Flag Value Function Comment -Q/--min-qcov-per-genome Default 50 Minimum query coverage (percentage) per genome. -q/--min-qcov-per-hsp Default 0 Minimum query coverage (percentage) per HSP. -l/--align-min-match-len Default 50 Minimum aligned length in a HSP segment. -i/--align-min-match-pident Default 70 Minimum base identity (percentage) in a HSP segment. --align-band Default 100 Band size in backtracking the score matrix. --align-ext-len Default 2000 Extend length of upstream and downstream of seed regions, for extracting query and target sequences for alignment. --align-max-gap Default 50 Maximum gap in a HSP segment. --align-max-mismatch Default 50 Maximum mismatch in a HSP segment. Steps For short queries like genes or long reads, returning top N hits.\nlexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 70 \\ --min-match-pident 70 \\ --min-qcov-per-hsp 70 \\ --top-n-genomes 500 For longer queries like plasmids, returning all hits.\nlexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 50 \\ --min-match-pident 70 \\ --min-qcov-per-hsp 0 \\ --top-n-genomes 0 Click to show the log of a demo run. ... $ lexicmap search -d demo.lmi/ q.gene.fasta -o q.gene.fasta.lexicmap.tsv 09:32:55.551 [INFO] LexicProf v0.3.0 09:32:55.551 [INFO] https://github.com/shenwei356/LexicMap 09:32:55.551 [INFO] 09:32:55.551 [INFO] checking input files ... 09:32:55.551 [INFO] 1 input file(s) given 09:32:55.551 [INFO] 09:32:55.551 [INFO] loading index: demo.lmi/ 09:32:55.551 [INFO] reading masks... 09:32:55.552 [INFO] reading indexes of seeds (k-mer-value) data... 09:32:55.555 [INFO] creating genome reader pools, each batch with 16 readers... 09:32:55.555 [INFO] index loaded in 4.192051ms 09:32:55.555 [INFO] 09:32:55.555 [INFO] searching ... 09:32:55.596 [INFO] 09:32:55.596 [INFO] processed queries: 1, speed: 1467.452 queries per minute 09:32:55.596 [INFO] 100.0000% (1/1) queries matched 09:32:55.596 [INFO] done searching 09:32:55.596 [INFO] search results saved to: q.gene.fasta.lexicmap.tsv 09:32:55.596 [INFO] 09:32:55.596 [INFO] elapsed time: 45.230604ms 09:32:55.596 [INFO] Output Alignment result relationship Query ├── Subject genome # A query might have one or more genome hits, ├── Subject sequence # in different sequences. ├── High-Scoring segment Pairs (HSP) # HSP is a cluster of alignment segments. ├── HSP segment # A local alignment with no gaps. Here, the defination of HSP is slightly different from that in BLAST.\nA High-scoring Segment Pair (HSP) is a local alignment with no gaps that achieves one of the highest alignment scores in a given search. https://www.ncbi.nlm.nih.gov/books/NBK62051/\nOutput format Tab-delimited format with 18 columns. (The positions are 1-based).\n1. query, Query sequence ID. 2. qlen, Query sequence length. 3. qstart, Start of alignment in query sequence. 4. qend, End of alignment in query sequence. 5. sgnms, The number of Subject genomes. 6. sgnm, Subject genome ID. 7. seqid, Subject sequence ID. 8. qcovGnm, Query coverage (percentage) per genome: $(aligned bases in the genome)/$qlen. 9. hsp, Nth HSP in the genome. 10. qcovHSP Query coverage (percentage) per HSP: $(aligned bases in a HSP)/$qlen. 11. alen, Aligned length in the current HSP, a HSP might have \u0026gt;=1 HSP segments. 12. alenSeg, Aligned length in the current HSP segment. 13. pident, Percentage of identical matches in the current HSP segment. 14. slen, Subject sequence length. 15. sstart, Start of HSP segment in subject sequence. 16. send, End of HSP segment in subject sequence. 17. sstr, Subject strand. 18. seeds, Number of seeds in the current HSP. Examples A 16S rRNA gene The (part) result shows the 16S rRNA gene has 12 genome hits (column sgnms). And in genome GCF_003697165.2, it has 7 highly similar matches with query coverage per HSP (column qcovHSP) \u0026gt; 99% and percentage of identity (pident) \u0026gt; 99%. It makes sense as 16S rRNA genes might have multiple copies in a genome.\nquery qlen qstart qend sgnms sgnm seqid qcovGnm hsp qcovHSP alenHSP alenSeg pident slen sstart send sstr seeds --------------------------- ---- ------ ---- ----- --------------- ------------- ------- --- ------- ------- ------- ------ ------- ------- ------- ---- ----- NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 1 99.287 1542 1542 99.287 4903501 4591684 4593225 - 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 2 99.287 1542 1542 99.287 4903501 4551515 4553056 - 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 3 99.287 1542 1542 99.287 4903501 3780640 3782181 - 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 4 99.287 1542 1542 99.287 4903501 1285123 1286664 + 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 5 99.287 1542 1542 99.287 4903501 4844587 4846128 - 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 6 99.287 1542 1542 99.287 4903501 458559 460100 + 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_003697165.2 NZ_CP033092.2 100.000 7 99.092 1542 1542 99.092 4903501 4726193 4727734 - 18 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_002950215.1 NZ_CP026788.1 100.000 1 99.027 1542 1542 99.027 4659463 3216505 3218046 + 15 NC_000913.3:4166659-4168200 1542 1 1542 12 GCF_002950215.1 NZ_CP026788.1 100.000 2 98.962 1542 1542 98.962 4659463 3396068 3397609 + 16 A plasmid This plasmid has 19,265 genome hits in the index (2.34 millions prokaryotic genome from Genbank and RefSeq). It is highly similar to the sequence CP058621.1 with query coverage of 99.388 and percentage of identity of 99.967. They also have similar sequence length qlen (51466) vs slen (51480). Besides there are a few duplicated sequences (might be multiple-copy genes) in the query and matches, e.g., a ~821-bp sequence (43100-43920) appears in multiple positions of sequences CP058620.1.\nquery qlen qstart qend sgnms sgnm seqid qcovGnm hsp qcovHSP alenHSP alenFrag pident slen sstart send sstr seeds ------- ----- ------ ----- ----- --------------- ------------- ------- --- ------- ------- -------- ------- ------- ------- ------- ---- ----- plasmid 51466 296 51450 19265 GCA_014826015.1 CP058621.1 100.000 1 99.388 51168 51168 99.967 51480 313 51480 - 497 plasmid 51466 27861 29179 19265 GCA_014826015.1 CP058618.1 100.000 2 2.563 1319 1319 100.000 4718403 3019498 3020816 + 9 plasmid 51466 43100 43920 19265 GCA_014826015.1 CP058620.1 100.000 3 1.673 861 821 100.000 67321 20250 21070 + 6 plasmid 51466 45163 45202 19265 GCA_014826015.1 CP058620.1 100.000 3 1.673 861 40 100.000 67321 22219 22258 + 6 plasmid 51466 43100 43920 19265 GCA_014826015.1 CP058620.1 100.000 4 1.595 821 821 100.000 67321 14895 15715 + 5 plasmid 51466 43101 43920 19265 GCA_014826015.1 CP058622.1 100.000 5 1.593 820 820 100.000 9135 3424 4243 - 5 plasmid 51466 43101 43920 19265 GCA_014826015.1 CP058620.1 100.000 6 1.593 820 820 100.000 67321 9690 10509 - 5 plasmid 51466 29791 30608 19265 GCA_014826015.1 CP058620.1 100.000 7 1.570 821 821 98.417 67321 20251 21071 + 5 plasmid 51466 29791 30608 19265 GCA_014826015.1 CP058620.1 100.000 8 1.570 821 821 98.417 67321 14896 15716 + 5 plasmid 51466 29791 30608 19265 GCA_014826015.1 CP058620.1 100.000 9 1.570 821 821 98.417 67321 9689 10509 - 5 plasmid 51466 29791 30607 19265 GCA_014826015.1 CP058622.1 100.000 10 1.568 820 820 98.415 9135 3424 4243 - 5 plasmid 51466 29791 30607 19265 GCA_014826015.1 CP058621.1 100.000 11 1.568 820 820 98.415 51480 7844 8663 - 5 plasmid 51466 43100 43865 19265 GCA_014826015.1 CP058622.1 100.000 12 1.488 766 766 100.000 9135 8370 9135 + 4 plasmid 51466 18302 18401 19265 GCA_014826015.1 CP058621.1 100.000 14 0.194 100 100 100.000 51480 27281 27380 + 2 plasmid 51466 34042 34125 19265 GCA_014826015.1 CP058621.1 100.000 15 0.146 84 84 89.286 51480 7143 7226 - 1 plasmid 51466 43866 43921 19265 GCA_014826015.1 CP058622.1 100.000 16 0.109 56 56 100.000 9135 1 56 + 2 plasmid 51466 30553 30607 19265 GCA_014826015.1 CP058622.1 100.000 17 0.107 55 55 100.000 9135 1 55 + 1 plasmid 51466 296 51450 19265 GCF_014826015.1 NZ_CP058621.1 100.000 1 99.388 51168 51168 99.967 51480 313 51480 - 497 plasmid 51466 27861 29179 19265 GCF_014826015.1 NZ_CP058618.1 100.000 2 2.563 1319 1319 100.000 4718403 3019498 3020816 + 9 Long reads Queries are a few Nanopore Q20 read. The column species is added by mapping genome ID (column sgnm) to taxonomic information.\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ query qlen qstart qend sgnms sgnm seqid qcovGnm hsp qcovHSP alenHSP alenSeg pident slen sstart send sstr seeds species ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ERR5396170.1000016 740 71 733 1 GCF_013394085.1 NZ_CP040910.1 89.595 1 89.595 663 663 98.492 1887974 13515 14177 + 19 Limosilactobacillus fermentum ERR5396170.1000017 516 27 514 1 GCF_013394085.1 NZ_CP040910.1 94.574 1 94.574 488 488 100.000 1887974 293509 293996 + 6 Limosilactobacillus fermentum ERR5396170.1000029 480 37 474 1 GCF_001027105.1 NZ_CP011526.1 91.042 1 91.042 437 437 95.423 2755072 821078 821514 + 1 Staphylococcus aureus ERR5396170.1000047 960 24 812 2 GCF_001027105.1 NZ_CP011526.1 91.979 1 91.979 883 803 89.015 2755072 2204718 2205520 - 7 Staphylococcus aureus ERR5396170.1000047 960 881 960 2 GCF_001027105.1 NZ_CP011526.1 91.979 1 91.979 883 80 89.015 2755072 2204568 2204647 - 7 Staphylococcus aureus ERR5396170.1000047 960 42 960 2 GCF_002902405.1 NZ_PPQS01000020.1 100.000 1 97.500 936 936 77.457 50421 25900 26835 + 3 Staphylococcus schweitzeri ERR5396170.1000047 960 42 950 2 GCF_002902405.1 NZ_PPQS01000020.1 100.000 2 96.458 926 926 77.214 50421 25900 26825 + 1 Staphylococcus schweitzeri ERR5396170.1000000 698 53 650 1 GCF_001457615.1 NZ_LN831024.1 86.390 1 86.390 603 603 96.517 6316979 4452083 4452685 + 4 Pseudomonas aeruginosa ERR5396170.1000005 2516 38 2510 5 GCF_000006945.2 NC_003197.2 98.490 1 98.490 2478 2478 98.951 4857450 3198806 3201283 + 14 Salmonella enterica ERR5396170.1000005 2516 38 2497 5 GCF_008692785.1 NZ_VXJV01000001.1 98.013 1 98.013 2466 2466 95.864 797633 423400 425865 + 8 Salmonella enterica ERR5396170.1000005 2516 40 2510 5 GCA_900478215.1 LS483478.1 98.450 1 98.450 2477 2477 95.317 4624613 785866 788342 - 12 Salmonella enterica ERR5396170.1000005 2516 1350 2497 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 1151 91.742 366711 6705 7855 + 9 Salmonella enterica ERR5396170.1000005 2516 634 1309 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 674 91.742 366711 5991 6664 + 9 Salmonella enterica ERR5396170.1000005 2516 387 608 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 221 91.742 366711 5745 5965 + 9 Salmonella enterica ERR5396170.1000005 2516 69 205 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 138 91.742 366711 5426 5563 + 9 Salmonella enterica ERR5396170.1000005 2516 306 325 5 GCF_008692845.1 NZ_VXJW01000004.1 87.599 1 87.599 2204 20 91.742 366711 5664 5683 + 9 Salmonella enterica ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Search results (TSV format) above are formatted with csvtk pretty.\n","description":"Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output Alignment result relationship Output format Examples TL;DR Build or download a LexicMap index.\nRun:\nFor short queries like genes or long reads, returning top N hits.\nlexicmap search -d db.lmi query.fasta -o query.fasta.lexicmap.tsv \\ --min-qcov-per-genome 70 --min-match-pident 70 --min-qcov-per-hsp 70 --top-n-genomes 500 For longer queries like plasmids, returning all hits.\nlexicmap search -d db.lmi query.fasta -o query."},{"id":5,"href":"/LexicMap/installation/","title":"Installation","parent":"","content":"LexicMap can be installed via conda, executable binary files, or compiling from the source.\nBesides, it supports shell completion, which could help accelerate typing.\nConda Install conda, then run\nconda install -c bioconda lexicmap Binary files Linux Download the binary file.\nOS Arch File, 中国镜像 Linux 64-bit lexicmap_linux_amd64.tar.gz, 中国镜像 Linux arm64 lexicmap_linux_arm64.tar.gz, 中国镜像 Decompress it\ntar -zxvf lexicmap_linux_amd64.tar.gz If you have the root privilege, simply copy it to /usr/local/bin:\nsudo cp lexicmap /usr/local/bin/ Or copy to anywhere in the environment variable PATH:\nmkdir -p $HOME/bin/; cp lexicmap $HOME/bin/ MacOS Download the binary file. OS Arch File, 中国镜像 macOS 64-bit lexicmap_darwin_amd64.tar.gz, 中国镜像 macOS arm64 lexicmap_darwin_arm64.tar.gz, 中国镜像 Windows Download the binary file.\nOS Arch File, 中国镜像 Windows 64-bit lexicmap_windows_amd64.exe.tar.gz, 中国镜像 Decompress it.\nCopy lexicmap.exe to C:\\WINDOWS\\system32.\nOthers Please open an issue to request binaries for other platforms. Or compiling from the source. Compile from the source Install go.\nwget https://go.dev/dl/go1.22.2.linux-amd64.tar.gz tar -zxf go1.22.2.linux-amd64.tar.gz -C $HOME/ # or # echo \u0026quot;export PATH=$PATH:$HOME/go/bin\u0026quot; \u0026gt;\u0026gt; ~/.bashrc # source ~/.bashrc export PATH=$PATH:$HOME/go/bin Compile LexicMap.\n# ------------- the latest stable version ------------- go get -v -u github.com/shenwei356/LexicMap/lexicmap # The executable binary file is located in: # ~/go/bin/lexicmap # You can also move it to anywhere in the $PATH mkdir -p $HOME/bin cp ~/go/bin/lexicmap $HOME/bin/ # --------------- the development version -------------- git clone https://github.com/shenwei356/LexicMap cd LexicMap/lexicmap/ go build # The executable binary file is located in: # ./lexicmap # You can also move it to anywhere in the $PATH mkdir -p $HOME/bin cp ./lexicmap $HOME/bin/ Shell-completion Supported shell: bash|zsh|fish|powershell\nBash:\n# generate completion shell lexicmap autocompletion --shell bash # configure if never did. # install bash-completion if the \u0026quot;complete\u0026quot; command is not found. echo \u0026quot;for bcfile in ~/.bash_completion.d/* ; do source \\$bcfile; done\u0026quot; \u0026gt;\u0026gt; ~/.bash_completion echo \u0026quot;source ~/.bash_completion\u0026quot; \u0026gt;\u0026gt; ~/.bashrc Zsh:\n# generate completion shell lexicmap autocompletion --shell zsh --file ~/.zfunc/_kmcp # configure if never did echo 'fpath=( ~/.zfunc \u0026quot;${fpath[@]}\u0026quot; )' \u0026gt;\u0026gt; ~/.zshrc echo \u0026quot;autoload -U compinit; compinit\u0026quot; \u0026gt;\u0026gt; ~/.zshrc fish:\nlexicmap autocompletion --shell fish --file ~/.config/fish/completions/lexicmap.fish ","description":"LexicMap can be installed via conda, executable binary files, or compiling from the source.\nBesides, it supports shell completion, which could help accelerate typing.\nConda Install conda, then run\nconda install -c bioconda lexicmap Binary files Linux Download the binary file.\nOS Arch File, 中国镜像 Linux 64-bit lexicmap_linux_amd64.tar.gz, 中国镜像 Linux arm64 lexicmap_linux_arm64.tar.gz, 中国镜像 Decompress it\ntar -zxvf lexicmap_linux_amd64.tar.gz If you have the root privilege, simply copy it to /usr/local/bin:\nsudo cp lexicmap /usr/local/bin/ Or copy to anywhere in the environment variable PATH:"},{"id":6,"href":"/LexicMap/usage/search/","title":"search","parent":"Usage","content":"$ lexicmap search -h Search sequences against an index Attention: 1. Input should be (gzipped) FASTA or FASTQ records from files or stdin. Alignment result relationship: Query ├── Subject genome ├── Subject sequence ├── High-Scoring segment Pairs (HSP) ├── HSP segment Output format: Tab-delimited format with 18 columns. (The positions are 1-based). 1. query, Query sequence ID. 2. qlen, Query sequence length. 3. qstart, Start of alignment in query sequence. 4. qend, End of alignment in query sequence. 5. sgnms, The number of Subject genomes. 6. sgnm, Subject genome ID. 7. seqid, Subject sequence ID. 8. qcovGnm, Query coverage (percentage) per genome: $(aligned bases in the genome)/$qlen. 9. hsp, Nth HSP in the genome. 10. qcovHSP Query coverage (percentage) per HSP: $(aligned bases in a HSP)/$qlen. 11. alen, Aligned length in the current HSP, a HSP might have \u0026gt;=1 HSP segments. 12. alenSeg, Aligned length in the current HSP segment. 13. pident, Percentage of identical matches in the current HSP segment. 14. slen, Subject sequence length. 15. sstart, Start of HSP segment in subject sequence. 16. send, End of HSP segment in subject sequence. 17. sstr, Subject strand. 18. seeds, Number of seeds in the current HSP. Usage: lexicmap search [flags] -d \u0026lt;index path\u0026gt; [query.fasta.gz ...] [-o query.tsv.gz] Flags: --align-band int ► Band size in backtracking the score matrix (default 100) --align-ext-len int ► Extend length of upstream and downstream of seed regions, for extracting query and target sequences for alignment (default 2000) --align-max-gap int ► Maximum gap in a HSP segment (default 50) --align-max-mismatch int ► Maximum mismatch in a HSP segment (default 50) -l, --align-min-match-len int ► Minimum aligned length in a HSP segment (default 50) -i, --align-min-match-pident float ► Minimum base identity (percentage) in a HSP segment. (default 70) -h, --help help for search -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -w, --load-whole-seeds ► Load the whole seed data into memory for faster search. --max-open-files int ► Maximum opened files. (default 512) -Q, --min-qcov-per-genome float ► Minimum query coverage (percentage) per genome. (default 50) -q, --min-qcov-per-hsp float ► Minimum query coverage (percentage) per HSP. -o, --out-file string ► Out file, supports and recommends a \u0026#34;.gz\u0026#34; suffix (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) --seed-max-dist int ► Max distance between seeds in seed chaining. (default 10000) --seed-max-gap int ► Max gap in seed chaining. (default 2000) -m, --seed-max-mismatch int ► Minimum mismatch between non-prefix regions of shared substrings. (default -1) -p, --seed-min-prefix int ► Minimum length of shared substrings (anchors). (default 15) -P, --seed-min-single-prefix int ► Minimum length of shared substrings (anchors) if there\u0026#39;s only one pair. (default 20) -n, --top-n-genomes int ► Keep top N genome matches for a query (0 for all). (default 500) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples See Searching ","description":"$ lexicmap search -h Search sequences against an index Attention: 1. Input should be (gzipped) FASTA or FASTQ records from files or stdin. Alignment result relationship: Query ├── Subject genome ├── Subject sequence ├── High-Scoring segment Pairs (HSP) ├── HSP segment Output format: Tab-delimited format with 18 columns. (The positions are 1-based). 1. query, Query sequence ID. 2. qlen, Query sequence length. 3. qstart, Start of alignment in query sequence. 4."},{"id":7,"href":"/LexicMap/usage/utils/subseq/","title":"subseq","parent":"utils","content":" Usage $ lexicmap utils subseq -h Exextract subsequence via reference name, sequence ID, position and strand Attention: 1. The option -s/--seq-id is optional. 1) If given, the positions are these in the original sequence. 2) If not given, the positions are these in the concatenated sequence. Usage: lexicmap utils subseq [flags] Flags: -h, --help help for subseq -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -w, --line-width int ► Line width of sequence (0 for no wrap). (default 60) -o, --out-file string ► Out file, supports and recommends a \u0026#34;.gz\u0026#34; suffix (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) -n, --ref-name string ► Reference name. -r, --region string ► Region of the subsequence (1-based). -R, --revcom ► Extract subsequence on the negative strand. -s, --seq-id string ► Sequence ID. If the value is empty, the positions in the region are treated as that in the concatenated sequence. Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples Extracting subsequence with genome ID, sequence ID, position range and strand information.\n$ lexicmap utils subseq -d demo.lmi/ -n GCF_003697165.2 -s NZ_CP033092.2 -r 4591684:4593225 -R \u0026gt;NZ_CP033092.2:4591684-4593225 AAATTGAAGAGTTTGATCATGGCTCAGATTGAACGCTGGCGGCAGGCCTAACACATGCAA GTCGAACGGTAACAGGAAGCAGCTTGCTGCTTTGCTGACGAGTGGCGGACGGGTGAGTAA TGTCTGGGAAACTGCCTGATGGAGGGGGATAACTACTGGAAACGGTAGCTAATACCGCAT AACGTCGCAAGACCAAAGAGGGGGACCTTAGGGCCTCTTGCCATCGGATGTGCCCAGATG GGATTAGCTAGTAGGTGGGGTAACGGCTCACCTAGGCGACGATCCCTAGCTGGTCTGAGA GGATGACCAGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTGG GGAATATTGCACAATGGGCGCAAGCCTGATGCAGCCATGCCGCGTGTATGAAGAAGGCCT TCGGGTTGTAAAGTACTTTCAGCGGGGAGGAAGGGAGTAAAGTTAATACCTTTGCTCATT GACGTTACCCGCAGAAGAAGCACCGGCTAACTCCGTGCCAGCAGCCGCGGTAATACGGAG GGTGCAAGCGTTAATCGGAATTACTGGGCGTAAAGCGCACGCAGGCGGTTTGTTAAGTCA GATGTGAAATCCCCGGGCTCAACCTGGGAACTGCATCTGATACTGGCAAGCTTGAGTCTC GTAGAGGGGGGTAGAATTCCAGGTGTAGCGGTGAAATGCGTAGAGATCTGGAGGAATACC GGTGGCGAAGGCGGCCCCCTGGACGAAGACTGACGCTCAGGTGCGAAAGCGTGGGGAGCA AACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGTCGACTTGGAGGTTGTGCC CTTGAGGCGTGGCTTCCGGAGCTAACGCGTTAAGTCGACCGCCTGGGGAGTACGGCCGCA AGGTTAAAACTCAAATGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAAT TCGATGCAACGCGAAGAACCTTACCTGGTCTTGACATCCACGGAAGTTTTCAGAGATGAG AATGTGCCTTCGGGAACCGTGAGACAGGTGCTGCATGGCTGTCGTCAGCTCGTGTTGTGA AATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTATCCTTTGTTGCCAGCGGTCCGGC CGGGAACTCAAAGGAGACTGCCAGTGATAAACTGGAGGAAGGTGGGGATGACGTCAAGTC ATCATGGCCCTTACGACCAGGGCTACACACGTGCTACAATGGCGCATACAAAGAGAAGCG ACCTCGCGAGAGCAAGCGGACCTCATAAAGTGCGTCGTAGTCCGGATTGGAGTCTGCAAC TCGACTCCATGAAGTCGGAATCGCTAGTAATCGTGGATCAGAATGCCACGGTGAATACGT TCCCGGGCCTTGTACACACCGCCCGTCACACCATGGGAGTGGGTTGCAAAAGAAGTAGGT AGCTTAACCTTCGGGAGGGCGCTTACCACTTTGTGATTCATGACTGGGGTGAAGTCGTAA CAAGGTAACCGTAGGGGAACCTGCGGTTGGATCACCTCCTTA If the sequence ID (-s/--seq-id) is not given, the positions are these in the concatenated sequence.\nChecking sequence lengths of a genome with seqkit.\n$ seqkit fx2tab -nil refs/GCF_003697165.2.fa.gz NZ_CP033092.2 4903501 NZ_CP033091.2 131333 Extracting the 1000-bp interval sequence inserted by lexicmap index.\n$ lexicmap utils subseq -d demo.lmi/ -n GCF_003697165.2 -r 4903502:4904501 \u0026gt;GCF_003697165.2:4903502-4904501 AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA ","description":"Usage $ lexicmap utils subseq -h Exextract subsequence via reference name, sequence ID, position and strand Attention: 1. The option -s/--seq-id is optional. 1) If given, the positions are these in the original sequence. 2) If not given, the positions are these in the concatenated sequence. Usage: lexicmap utils subseq [flags] Flags: -h, --help help for subseq -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -w, --line-width int ► Line width of sequence (0 for no wrap)."},{"id":8,"href":"/LexicMap/releases/","title":"Releases","parent":"","content":" Latest version v0.3.0 v0.3.0 - 2024-04-xx lexicmap index: Generate masks from the top N biggest genomes instead of randomly generation. Use longer (1000bp N\u0026rsquo;s, previous: k-1) intervals between contigs. Fix a concurrency bug between genome data writing and k-mer-value data collecting. Change the format of k-mer-value index file, and fix the computation of index partitions. lexicmap search: Better support of long queries. Add a new flag -w/--load-whole-seeds for loading the whole seed data into memory for faster search. Parallelize alignment in each query, so it\u0026rsquo;s faster for a single query. Change output format. Add output of query start and end positions. Fix a seed-chaining bug. Fix a target sequence extracting bug. Keep indexes of genome data in memory. lexicmap utils kmers: Fix a little bug, wrong number of k-mers for the second k-mer in each k-mer pair. New commands: lexicmap utils gen-masks for generating masks from the top N largest genomes. lexicmap utils seed-pos for extracting seed positions via reference names. lexicmap utils reindex-seeds for recreating indexes of k-mer-value (seeds) data. Please run lexicmap version to check update !!! Please run lexicmap autocompletion to update shell autocompletion script !!! Previous versions v0.2.0 v0.2.0 - 2024-02-02 Software architecture and index formats are redesigned to reduce searching memory occupation. Indexing: genomes are processed in batches to reduce RAM usage, then indexes of all batches are merged. Searching: seeds matching is performed on disk yet it\u0026rsquo;s ultra-fast. v0.1.0 v0.1.0 - 2024-01-15 The first release. Seed indexing and querying are performed in RAM. GTDB r214 with 10k masks: index size 75GB, RAM: 130GB. ","description":"Latest version v0.3.0 v0.3.0 - 2024-04-xx lexicmap index: Generate masks from the top N biggest genomes instead of randomly generation. Use longer (1000bp N\u0026rsquo;s, previous: k-1) intervals between contigs. Fix a concurrency bug between genome data writing and k-mer-value data collecting. Change the format of k-mer-value index file, and fix the computation of index partitions. lexicmap search: Better support of long queries. Add a new flag -w/--load-whole-seeds for loading the whole seed data into memory for faster search."},{"id":9,"href":"/LexicMap/usage/utils/seed-pos/","title":"seed-pos","parent":"utils","content":" Usage $ lexicmap utils seed-pos -h Extract seed positions via reference names Attentions: 0. This command requires the index to be created with the flag --save-seed-pos in lexicmap index. 1. Seed/K-mer positions (column pos) are 1-based. For reference genomes with multiple sequences, the sequences were concatenated to a single sequence with intervals of N\u0026#39;s. Usage: lexicmap utils seed-pos [flags] Flags: -a, --all-refs ► Output for all reference genomes. This would take a long time for an index with a lot of genomes. -b, --bins int ► Number of bins in histograms. (default 100) --color-index int ► Color index (1-7). (default 1) --force ► Overwrite existing output directory. --height float ► Histogram height (unit: inch). (default 4) -h, --help help for seed-pos -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -o, --out-file string ► Out file, supports and recommends a \u0026#34;.gz\u0026#34; suffix (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) -O, --plot-dir string ► Output directory for histograms of seed distances. --plot-ext string ► Histogram plot file extention. (default \u0026#34;.png\u0026#34;) -t, --plot-title ► Plot genome ID as the title. -n, --ref-name strings ► Reference name(s). --width float ► Histogram width (unit: inch). (default 6) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples Adding the flag --save-seed-pos in index building.\n$ lexicmap index -I refs/ -O demo.lmi --top-n 3 --save-seed-pos --force Listing seed position of one genome.\n$ lexicmap utils seed-pos -d demo.lmi/ -n GCF_000006945.2 -o seed_distance.tsv $ head -n 10 seed_distance.tsv | csvtk pretty -t ref pos strand distance --------------- --- ------ -------- GCF_000006945.2 113 + 112 GCF_000006945.2 291 - 178 GCF_000006945.2 297 - 6 GCF_000006945.2 299 - 2 GCF_000006945.2 322 + 23 GCF_000006945.2 340 + 18 GCF_000006945.2 389 + 49 GCF_000006945.2 533 - 144 GCF_000006945.2 598 - 65 Check the biggest seed distances.\n$ csvtk freq -t -f distance seed_distance.tsv \\ | csvtk sort -t -k distance:nr \\ | head -n 20 \\ | csvtk pretty -t distance frequency -------- --------- 1586 1 1434 1 1418 1 1398 1 1282 2 1268 1 1261 1 1233 1 1175 1 1166 1 1158 1 1129 1 1106 1 1079 2 1074 1 1066 1 1060 1 1041 1 1034 2 Plot the histogram of distances between seeds.\n$ lexicmap utils seed-pos -d demo.lmi/ -n GCF_000006945.2 -o seed_distance.tsv --plot-dir seed_distance Listing seed position of all genomes.\n$ lexicmap utils seed-pos -d demo.lmi/ --all-refs -o seed-pos.tsv.gz Show the number of seed positions in each genome. Frequencies larger than 40000 (the number of masks) means some k-mers can be foud in more than one positions in a genome.\n$ csvtk freq -t -f ref -nr seed-pos.tsv.gz | csvtk pretty -t ref frequency --------------- --------- GCF_002950215.1 43149 GCF_002949675.1 42888 GCF_001457655.1 42444 GCF_006742205.1 42050 GCF_900638025.1 41939 GCF_001027105.1 41925 GCF_000392875.1 41487 GCF_009759685.1 41058 GCF_000148585.2 41029 GCF_000017205.1 41012 GCF_000006945.2 41002 GCF_003697165.2 40785 GCF_000742135.1 40632 GCF_001096185.1 40234 GCF_001544255.1 40188 Plot the histograms of distances between seeds for all genomes.\n$ lexicmap utils seed-pos -d demo.lmi/ --all-refs -o seed-pos.tsv.gz --plot-dir seed_distance processed files: 15 / 15 [======================================] ETA: 0s. done 11:48:31.346 [INFO] seed positions of 15 genomes(s) saved to seed-pos.tsv.gz 11:48:31.346 [INFO] histograms of 15 genomes(s) saved to seed_distance $ ls seed_distance/ GCF_000006945.2.png GCF_000392875.1.png GCF_001096185.1.png GCF_002949675.1.png GCF_006742205.1.png GCF_000017205.1.png GCF_000742135.1.png GCF_001457655.1.png GCF_002950215.1.png GCF_009759685.1.png GCF_000148585.2.png GCF_001027105.1.png GCF_001544255.1.png GCF_003697165.2.png GCF_900638025.1.png The output (TSV format) is formatted with csvtk pretty.\n","description":"Usage $ lexicmap utils seed-pos -h Extract seed positions via reference names Attentions: 0. This command requires the index to be created with the flag --save-seed-pos in lexicmap index. 1. Seed/K-mer positions (column pos) are 1-based. For reference genomes with multiple sequences, the sequences were concatenated to a single sequence with intervals of N\u0026#39;s. Usage: lexicmap utils seed-pos [flags] Flags: -a, --all-refs ► Output for all reference genomes. This would take a long time for an index with a lot of genomes."},{"id":10,"href":"/LexicMap/usage/utils/gen-masks/","title":"gen-masks","parent":"utils","content":" Usage $ lexicmap utils gen-masks -h Generate masks from the top N largest genomes How: |ATTATAACGCCACGGGGAGCCGCGGGGTTTC One k-bp mask |--------========_______________ | |-------- Prefixes for covering all possible P-bp DNA. | The length is the largest number for 4^P \u0026lt;= #masks | |--------======== Extend prefixes, chosen from the most frequent extended prefixes | of which the prefix-derived k-mers do not overlap masked k-mers. | | _______________ Randomly generated bases Usage: lexicmap utils gen-masks [flags] [-k \u0026lt;k\u0026gt;] [-n \u0026lt;masks\u0026gt;] [-n \u0026lt;top-n\u0026gt;] [-D \u0026lt;seeds.tsv.gz\u0026gt;] [-o masks.txt] { -I \u0026lt;seqs dir\u0026gt; | -X \u0026lt;file list\u0026gt;} Flags: -G, --big-genomes string ► Out file of skipped files with genomes \u0026gt;= -G/--max-genome -r, --file-regexp string ► Regular expression for matching sequence files in -I/--in-dir, case ignored. (default \u0026#34;\\\\.(f[aq](st[aq])?|fna)(.gz)?$\u0026#34;) -h, --help help for gen-masks -I, --in-dir string ► Directory containing FASTA/Q files. Directory symlinks are followed. -k, --kmer int ► Maximum k-mer size. K needs to be \u0026lt;= 32. (default 31) -m, --masks int ► Number of masks. (default 40000) -g, --max-genome int ► Maximum genome size. Extremely large genomes (non-isolate assemblies) will be skipped. (default 15000000) -o, --out-file string ► Out file of generated masks. The \u0026#34;.gz\u0026#34; suffix is not recommended. (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) -P, --prefix-ext int ► Extension length of prefixes, higher values -\u0026gt; smaller maximum seed distances. (default 8) -s, --rand-seed int ► Rand seed for generating random masks. (default 1) -N, --ref-name-regexp string ► Regular expression (must contains \u0026#34;(\u0026#34; and \u0026#34;)\u0026#34;) for extracting the reference name from the filename. (default \u0026#34;(?i)(.+)\\\\.(f[aq](st[aq])?|fna)(.gz)?$\u0026#34;) -D, --seed-pos string ► Out file of seed postions and distances, supports and recommends a \u0026#34;.gz\u0026#34; suffix. -B, --seq-name-filter strings ► List of regular expressions for filtering out sequences by header/name, case ignored. -S, --skip-file-check ► Skip input file checking when given files or a file list. -n, --top-n int ► Select the top N largest genomes for generating masks. (default 20) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples This command only generate masks, the flags are the same as these in lexicmap index.\n$ lexicmap utils gen-masks -I refs/ -k 31 --top-n 3 --masks 40000 -o masks.txt $ head -n 10 masks.txt AAAAAAACAGGGGCACGACGGTTTATGAGCT AAAAAACCGCCGGCCAGGGAAAGCTCATGCC AAAAAAGCCCCGCGAGACAAAGCGAAAATAG AAAAAATACTGTCTGGCTAGCGTTTCGGGGA AAAAACAACCTTGCTTCGTCGTTCCAGTGCC AAAAACCCATCACTTCTGTGGCCGGTGTATC AAAAACGCAACTGAAGACGCCGACAAACTCT AAAAACTCCATGAAACCCACAATATAAATAG AAAAAGAAACGCTCAATAATTTGTATGGTTT AAAAAGCCGCGCGGTTCAGATGGACGGCATT The generated masks could be used in lexicmap index via the flag -M/--mask-file.\n","description":"Usage $ lexicmap utils gen-masks -h Generate masks from the top N largest genomes How: |ATTATAACGCCACGGGGAGCCGCGGGGTTTC One k-bp mask |--------========_______________ | |-------- Prefixes for covering all possible P-bp DNA. | The length is the largest number for 4^P \u0026lt;= #masks | |--------======== Extend prefixes, chosen from the most frequent extended prefixes | of which the prefix-derived k-mers do not overlap masked k-mers. | | _______________ Randomly generated bases Usage: lexicmap utils gen-masks [flags] [-k \u0026lt;k\u0026gt;] [-n \u0026lt;masks\u0026gt;] [-n \u0026lt;top-n\u0026gt;] [-D \u0026lt;seeds."},{"id":11,"href":"/LexicMap/tutorials/","title":"Tutorials","parent":"","content":"","description":""},{"id":12,"href":"/LexicMap/usage/utils/","title":"utils","parent":"Usage","content":"$ lexicmap utils Some utilities Usage: lexicmap utils [command] Available Commands: gen-masks Generate masks from the top N largest genomes kmers View k-mers captured by the masks masks View masks of the index or generate new masks randomly reindex-seeds Recreate indexes of k-mer-value (seeds) data seed-pos Extract seed positions via reference names subseq Extract subsequence via reference name, sequence ID, position and strand Flags: -h, --help help for utils Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) The output (TSV format) is formatted with csvtk pretty.\n","description":"$ lexicmap utils Some utilities Usage: lexicmap utils [command] Available Commands: gen-masks Generate masks from the top N largest genomes kmers View k-mers captured by the masks masks View masks of the index or generate new masks randomly reindex-seeds Recreate indexes of k-mer-value (seeds) data seed-pos Extract seed positions via reference names subseq Extract subsequence via reference name, sequence ID, position and strand Flags: -h, --help help for utils Global Flags: -X, --infile-list string ► File of input files list (one file per line)."},{"id":13,"href":"/LexicMap/usage/utils/reindex-seeds/","title":"reindex-seeds","parent":"utils","content":" Usage $ lexicmap utils reindex-seeds -h Recreate indexes of k-mer-value (seeds) data Usage: lexicmap utils reindex-seeds [flags] Flags: -h, --help help for reindex-seeds -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -p, --partitions int ► Number of partitions for re-indexing seeds (k-mer-value data) files. (default 512) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16 Examples $ lexicmap utils reindex-seeds -d demo.lmi/ -p 1024 10:20:29.150 [INFO] recreating seed indexes with 1024 partitions for: demo.lmi/ processed files: 16 / 16 [======================================] ETA: 0s. done 10:20:29.166 [INFO] update index information file: demo.lmi/info.toml 10:20:29.166 [INFO] finished updating the index information file: demo.lmi/info.toml 10:20:29.166 [INFO] 10:20:29.166 [INFO] elapsed time: 15.981266ms 10:20:29.166 [INFO] ","description":"Usage $ lexicmap utils reindex-seeds -h Recreate indexes of k-mer-value (seeds) data Usage: lexicmap utils reindex-seeds [flags] Flags: -h, --help help for reindex-seeds -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -p, --partitions int ► Number of partitions for re-indexing seeds (k-mer-value data) files. (default 512) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments."},{"id":14,"href":"/LexicMap/usage/","title":"Usage","parent":"","content":"","description":""},{"id":15,"href":"/LexicMap/faqs/","title":"FAQs","parent":"","content":" Does LexicMap support fungi genomes? No. LexicMap only supports smal genomes including prokaryotic, viral, and plasmid genomes.\nDoes LexicMap support short reads? No. LexicMap only supports long (\u0026gt;=500 bp) reads or gene/genome/virus/plasmid/phage sequences. However, some short queries can also be aligned.\nHow\u0026rsquo;s the hardware requirement? For index building.\nMore CPUs would accelerate indexing. The memory occupation is linear with The size of the genome batch. The number of LexicHash masks. For seaching.\nMore CPUs would accelerate searching. The memory occupation mainly depends on the length of queries, the number of hits, and band size in backtracking. Why is LexicMap slow for batch searching? LexicMap is mainly designed for sequence alignment with a small number of queries against a database with a huge number of genomes.\nlexicmap search has a flag -w/--load-whole-seeds to load the whole seed data into memory for faster search.\nFor example, for ~85,000 GTDB representative genomes, searching on an index built with 20,000 masks, the memory would be ~100 GB with default parameters. Click to read more detail of the usage. ","description":"Does LexicMap support fungi genomes? No. LexicMap only supports smal genomes including prokaryotic, viral, and plasmid genomes.\nDoes LexicMap support short reads? No. LexicMap only supports long (\u0026gt;=500 bp) reads or gene/genome/virus/plasmid/phage sequences. However, some short queries can also be aligned.\nHow\u0026rsquo;s the hardware requirement? For index building.\nMore CPUs would accelerate indexing. The memory occupation is linear with The size of the genome batch. The number of LexicHash masks."},{"id":16,"href":"/LexicMap/notes/","title":"Notes","parent":"","content":"","description":""},{"id":17,"href":"/LexicMap/","title":"","parent":"","content":" LexicMap LexicMap is a sequence alignment tool aiming to efficiently query gene or plasmid sequences against up to millions of prokaryotic genomes. Quick start Feature overview Easy to install Both x86 and ARM CPUs are supported. Just install it by\nconda install -c bioconda lexicmap Or download the binary files for popular patforms.\nInstallation Releases Easy to use # indexing lexicmap index -I genomes/ -O db.lmi # searching lexicmap search -d db.lmi q.fasta -o r.tsv Introduction Tutorials Usages FAQs Notes Efficient search Querying a 51.5-kb plasmid in all 2,340,672 Genbank+Refseq prokaryotic genomes takes only 3 minutes and 32 seconds with 15.7 GB RAM and 48 CPUs, with 19,265 genome hits returned.\nPerformance ","description":"LexicMap LexicMap is a sequence alignment tool aiming to efficiently query gene or plasmid sequences against up to millions of prokaryotic genomes. Quick start Feature overview Easy to install Both x86 and ARM CPUs are supported. Just install it by\nconda install -c bioconda lexicmap Or download the binary files for popular patforms.\nInstallation Releases Easy to use # indexing lexicmap index -I genomes/ -O db.lmi # searching lexicmap search -d db."},{"id":18,"href":"/LexicMap/tutorials/index/","title":"Building an index","parent":"Tutorials","content":" Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names. Run: From a directory with multiple genome files:\nlexicmap index -I genomes/ -O db.lmi From a file list with one file per line:\nlexicmap index -X files.txt -O db.lmi Input Genome size\nLexicMap is only suitable for small genomes like Archaea, Bacteria, Viruses and plasmids. Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names.\nFile type: FASTA/Q files, in plain text or gzip-compressed format. File name: \u0026ldquo;Genome ID\u0026rdquo; + \u0026ldquo;File extention\u0026rdquo;. E.g., GCF_000006945.2.fa.gz. Genome ID: they should be distinctive for accurate result interpretation, which will be shown in the search result. File extention: a regular expression set by the flag -N/--ref-name-regexp is used to extract genome IDs from the file name. The default value supports common sequence file extentions, including .fa, .fasta, .fna, .fa.gz, .fasta.gz, and .fna.gz. Sequences: Only DNA or RNA sequences are supported. Sequence IDs should be distinctive for accurate result interpretation, which will be shown in the search result. One or more sequences are allowed. Unwanted sequences can be filtered out by regular expressions from the flag -B/--seq-name-filter. Genome size limit. Some none-isolate assemblies might have extremely large genomes, e.g., GCA_000765055.1 has \u0026gt;150 Mb. The flag -g/--max-genome (default 15 Mb) is used to skip these input files, and the file list would be written to a file via the flag -G/--big-genomes.. At most 17,179,869,184 genomes are supported. For more genomes, just build multiple indexes. Input files can be given via one of the following ways:\nPositional arguments. For a few input files. A file list via the flag -X/--infile-list with one file per line. It can be STDIN (-), e.g., you can filter a file list and pass it to lexicmap. A directory containing input files via the flag -I/--in-dir. Multiple-level directories are supported. Directory and file symlinks are followed. Hardware requirements LexicMap is designed to provide fast and low-memory sequence alignment against millions of prokaryotic genomes.\nCPU: No specific requirements on CPU type and instruction sets. Both x86 and ARM chips are supported. More is better as LexicMap is a CPU-intensive software. It uses all CPUs by default (-j/--threads). RAM More RAM (\u0026gt; 50 GB) is preferred. The memory usage in index building is mainly related to: The number of masks (-m, --masks, default 40,000). The number of genome. The divergence between genome sequences. The genome batch size (-b/--batch-size, default 10,000). If the RAM is not sufficient (\u0026lt; 50 GB). Please: Use a smaller genome batch size. It decreases indexing memory occupation and has little effect on searching performance. Use a smaller number of masks, e.g., 20,000 performs well for small genomes (\u0026lt;=5 Mb). And if the queries are long (\u0026gt;= 2kb), there\u0026rsquo;s little affection for the alignment results. Disk More (\u0026gt;2 TB) is better. The index size is related to the input genomes and the number of masks. See some examples. SSD disks are preferred, while HDD disks are also fast enough. Algorithm Generating LexicHash masks.\n|ATTATAACGCCACGGGGAGCCGCGGGGTTTC One k-bp mask |--------========_______________ | |-------- Prefixes for covering all possible P-bp DNA. | The length is the largest number for 4^P \u0026lt;= #masks | |--------======== Extend prefixes, chosen from the most frequent extended prefixes | of which the prefix-derived k-mers do not overlap masked k-mers. | | _______________ Randomly generated bases Reading all input genomes and getting the genome size information. Recording k-mers on the positive and negative strands of the top N biggest genomes. Generating all permutations of p-bp prefixes that can cover all possible k-mers, p is the biggest value for 4p \u0026lt;= M (desired number of masks), e.g., p=7 for 40,000 masks. For each prefix. Counting the k-mer frequencies of extend prefixes (-P/--prefix-ext, default 8) for each top N genome, and randomly choose one from the most frequent one. Randomly generating left k-p-P bases. Capturing the most similar k-mer in each genome, and record k-mer locations in a interval tree. Go to 1.4.1, and only counting k-mers which do not overlap existing regions. Generate left M - 4p masks similary, with a few differences. Only generating masks with non-low-complexity prefixes. If there\u0026rsquo;s no available k-mers for a extend prefix, just randomly generate one. Building an index for each genome batch (-b/--batch-size, default 10000, max 131072).\nFor each genome file in a genome batch. Optionally discarding sequences via regular expression (-B/--seq-name-filter). Skipping genomes bigger than the value of -g/--max-genome. Concatenating all sequences, with intervals of 1000-bp N\u0026rsquo;s. Capureing the most similar k-mer for each mask and saving k-mer and its location(s) and strand information. Saving the concatenated genome sequence (bit-packed, 2 bits for one base) and genome information (genome ID, size, and lengths of all sequences) into the genome data file, and creating an index file for the genome data file for fast random subsequence extraction. Compressing k-mer and the corresponding data (k-mer-data, or seeds data, including genome batch, genome number, location, and strand) into chunks of files, and creating an index file for each k-mer-data file for fast seeding. Writing summary information into info.toml file. Merging indexes of multiple batches.\nParameters Flags in bold text are important and frequently used.\nGenome batches Flag Value Function Comment -b/--batch-size Maximum: 131072, default: 10000 Maximum number of genomes in each batch If the number of input files exceeds this number, input files are into multiple batches and indexes are built for all batches. Next, seed files are merged into a big one, while genome data files are kept unchanged and collected. ► Bigger values increase indexing memory occupation. LexicHash mask generation Flag Value Function Comment -M/--mask-file A file File with custom masks It could be generated by lexicmap utils gen-masks. This flag oversides -k/--kmer, -m/--masks, -s/--rand-seed, -n/--top-n, and -P/--prefix-ext. -k/--kmer Maximum: 32, default: 31 K-mer size Bigger values improve the search specificity and do not increase the index size. -m/--masks Default: 40000 Number of masks Bigger values improve the search sensitivity and increase the index size. -n/--top-n Default: 20 The top N largest genomes for generating masks. Bigger values increase the indexing memory occupation (1.0~1.5 GB per genome for 20k masks). -P/--prefix-ext Default: 8 Extension length of prefixes Bigger values improve the search sensitivity by decreasing the maximum seed distances. Seeds (k-mer-value) data Flag Value Function Comment -c/--chunks Maximum: 128, default: #CPUs Number of seed file chunks Bigger values accelerate the search speed at the cost of a high disk reading load. The maximum number should not exceed the maximum number of open files set by the operating systems. -p/--partitions Default: 512 Number of partitions for indexing each seed file Bigger values bring higher memory occupation. 512 is a good value with high searching speed, larger or smaller values would decrease the speed in lexicmap search. ► After indexing, lexicmap utils reindex-seeds can be used to reindex the seeds data with another value of this flag. --max-open-files Default: 512 Maximum number of open files It\u0026rsquo;s only used in merging indexes of multiple genome batches. Also see the usage of lexicmap index.\nSteps We use a small dataset for demonstration.\nPreparing the test genomes (15 bacterial genomes) in the refs directory.\nNote that the genome files contain the assembly accessions (ID) in the file names.\ngit clone https://github.com/shenwei356/LexicMap cd LexicMap/demo/ ls refs/ GCF_000006945.2.fa.gz GCF_000392875.1.fa.gz GCF_001096185.1.fa.gz GCF_002949675.1.fa.gz GCF_006742205.1.fa.gz GCF_000017205.1.fa.gz GCF_000742135.1.fa.gz GCF_001457655.1.fa.gz GCF_002950215.1.fa.gz GCF_009759685.1.fa.gz GCF_000148585.2.fa.gz GCF_001027105.1.fa.gz GCF_001544255.1.fa.gz GCF_003697165.2.fa.gz GCF_900638025.1.fa.gz Building an index with genomes from a directory.\nlexicmap index -I refs/ -O demo.lmi It would take about 3 minutes and 10 GB RAM in a 16-CPU PC. You can use a smaller value of -n/--top-n to decrease memory usage.\nOptionally, we can also use a file list as the input.\n$ head -n 3 files.txt refs/GCF_000006945.2.fa.gz refs/GCF_000017205.1.fa.gz refs/GCF_000148585.2.fa.gz lexicmap index -X files.txt -O demo.lmi Click to show the log of a demo run. ... $ lexicmap index -I refs/ -O demo.lmi --top-n 4 --batch-size 5 21:27:50.928 [INFO] LexicMap v0.3.0 21:27:50.928 [INFO] https://github.com/shenwei356/LexicMap 21:27:50.928 [INFO] 21:27:50.928 [INFO] checking input files ... 21:27:50.928 [INFO] 15 input file(s) given 21:27:50.928 [INFO] 21:27:50.928 [INFO] --------------------- [ main parameters ] --------------------- 21:27:50.928 [INFO] 21:27:50.928 [INFO] input and output: 21:27:50.928 [INFO] input directory: refs/ 21:27:50.928 [INFO] regular expression of input files: (?i)\\.(f[aq](st[aq])?|fna)(.gz)?$ 21:27:50.928 [INFO] *regular expression for extracting reference name from file name: (?i)(.+)\\.(f[aq](st[aq])?|fna)(.gz)?$ 21:27:50.928 [INFO] *regular expressions for filtering out sequences: [] 21:27:50.928 [INFO] max genome size: 15000000 21:27:50.928 [INFO] output directory: demo.lmi 21:27:50.928 [INFO] 21:27:50.928 [INFO] k-mer size: 31 21:27:50.928 [INFO] number of masks: 40000 21:27:50.928 [INFO] rand seed: 1 21:27:50.928 [INFO] top N genomes for generating mask: 4 21:27:50.928 [INFO] prefix extension length: 8 21:27:50.928 [INFO] 21:27:50.928 [INFO] seeds data chunks: 16 21:27:50.928 [INFO] seeds data indexing partitions: 512 21:27:50.928 [INFO] 21:27:50.928 [INFO] genome batch size: 5 21:27:50.928 [INFO] 21:27:50.928 [INFO] 21:27:50.928 [INFO] --------------------- [ generating masks ] --------------------- 21:27:50.928 [INFO] 21:27:50.928 [INFO] generating masks from the top 4 out of 15 genomes... 21:27:50.928 [INFO] 21:27:50.928 [INFO] checking genomes sizes of 15 files... processed files: 15 / 15 [======================================] ETA: 0s. done 21:27:50.979 [INFO] 0 genomes longer than 15000000 are filtered out 21:27:50.979 [INFO] genome size range in the top 4 files: [4951383, 6588339] 21:27:50.979 [INFO] 21:27:50.979 [INFO] collecting k-mers from 4 files... processed files: 4/4 21:27:57.633 [INFO] 21:27:57.633 [INFO] generating masks... 21:27:57.638 [INFO] generating 16384 masks covering all 7-bp prefixes... processed prefixes: 16384/16384 21:28:19.639 [INFO] generating left 23616 masks... processed prefixes: 23616/23616 21:28:45.343 [INFO] 21:28:45.343 [INFO] maximum distance between seeds: 21:28:45.345 [INFO] GCF_000006945.2: 1092 21:28:45.346 [INFO] GCF_003697165.2: 1151 21:28:45.347 [INFO] GCF_000742135.1: 1406 21:28:45.348 [INFO] GCF_000017205.1: 1050 21:28:45.358 [INFO] 21:28:45.358 [INFO] finished generating masks in: 54.430001475s 21:28:45.359 [INFO] 21:28:45.359 [INFO] --------------------- [ building index ] --------------------- 21:28:45.518 [INFO] 21:28:45.518 [INFO] ------------------------[ batch 0 ]------------------------ 21:28:45.518 [INFO] building index for batch 0 with 5 files... processed files: 5 / 5 [======================================] ETA: 0s. done 21:28:46.720 [INFO] writing seeds... 21:28:46.864 [INFO] finished writing seeds in 144.463288ms 21:28:46.864 [INFO] finished building index for batch 0 in: 1.345988413s 21:28:46.864 [INFO] 21:28:46.864 [INFO] ------------------------[ batch 1 ]------------------------ 21:28:46.864 [INFO] building index for batch 1 with 5 files... processed files: 5 / 5 [======================================] ETA: 0s. done 21:28:48.637 [INFO] writing seeds... 21:28:48.816 [INFO] finished writing seeds in 178.371487ms 21:28:48.816 [INFO] finished building index for batch 1 in: 1.951457718s 21:28:48.816 [INFO] 21:28:48.816 [INFO] ------------------------[ batch 2 ]------------------------ 21:28:48.816 [INFO] building index for batch 2 with 5 files... processed files: 5 / 5 [======================================] ETA: 0s. done 21:28:50.171 [INFO] writing seeds... 21:28:50.347 [INFO] finished writing seeds in 175.806993ms 21:28:50.347 [INFO] finished building index for batch 2 in: 1.53094663s 21:28:50.347 [INFO] 21:28:50.347 [INFO] merging 3 indexes... 21:28:50.347 [INFO] [round 1] 21:28:50.347 [INFO] batch 1/1, merging 3 indexes to demo.lmi.tmp/r1_b1 21:28:50.919 [INFO] [round 1] finished in 572.049922ms 21:28:50.919 [INFO] rename demo.lmi.tmp/r1_b1 to demo.lmi 21:28:50.924 [INFO] 21:28:50.924 [INFO] finished building LexicMap index from 15 files with 40000 masks in 59.996543239s 21:28:50.924 [INFO] LexicMap index saved: demo.lmi 21:28:50.924 [INFO] 21:28:50.924 [INFO] elapsed time: 59.996570756s 21:28:50.924 [INFO] Output The LexicMap index is a directory with multiple files.\nFile structure $ tree demo.lmi/ demo.lmi/ # the index directory ├── genomes # directory of genome data │ └── batch_0000 # genome data of a batch │ ├── genomes.bin # genome data file, containing genome ID, size, sequence lengths, bit-packed sequences │ └── genomes.bin.idx # index of genome data file, for fast subsequence extraction ├── seeds # seed data: pairs of k-mer and its location information (genome batch, genome number, location, strand) │ ├── chunk_000.bin # seed data file │ ├── chunk_000.bin.idx # index of seed data file, for fast seed searching and data extraction ... ... ... │ ├── chunk_015.bin # the number of chunks is set by flag `-c/--chunks`, default: #cpus │ └── chunk_015.bin.idx ├── genomes.map.bin # mapping genome ID to batch number of genome number in the batch ├── info.toml # summary of the index ├── masks.bin # mask data Index size Demo data # 15 genomes $ dirsize demo.lmi/ demo.lmi/: 26.63 MB 13.39 MB seeds 12.93 MB genomes 312.53 KB masks.bin 375.00 B genomes.map.bin 261.00 B info.toml GTDB repr # 85,205 genomes gtdb_repr.lmi: 109.16 GB 66.79 GB genomes 42.37 GB seeds 2.03 MB genomes.map.bin 312.53 KB masks.bin 267.00 B info.toml GTDB complete # 402,538 genomes gtdb_complete.lmi: 506.57 GB 362.99 GB genomes 143.57 GB seeds 9.60 MB genomes.map.bin 312.53 KB masks.bin 269.00 B info.toml Genbank\u0026#43;RefSeq # 2,340,672 genomes genbank_refseq.lmi: 2.90 TB 2.17 TB genomes 754.04 GB seeds 55.81 MB genomes.map.bin 312.53 KB masks.bin 271.00 B info.toml AllTheBacteria HQ # 1,858,610 genomes 2kk-HQ.lmi: 2.32 TB 1.77 TB genomes 563.16 GB seeds 39.22 MB genomes.map.bin 312.53 KB masks.bin 271.00 B info.toml Index building parameters: -k 31 -m 40000. Genome batch size: -b 10000 for GTDB datasets, -b 131072 for others.\nWhat\u0026rsquo;s next: Searching ","description":"Table of contents Table of contents TL;DR Input Hardware requirements Algorithm Parameters Steps Output File structure Index size TL;DR Prepare input files: Sequences of each reference genome should be saved in separate FASTA/Q files, with identifiers in the file names. Run: From a directory with multiple genome files:\nlexicmap index -I genomes/ -O db.lmi From a file list with one file per line:\nlexicmap index -X files.txt -O db.lmi Input Genome size"},{"id":19,"href":"/LexicMap/usage/lexicmap/","title":"lexicmap","parent":"Usage","content":"$ lexicmap -h LexicMap: efficient sequence alignment against millions of prokaryotic genomes Version: v0.3.0 Documents: https://bioinf.shenwei.me/LexicMap Source code: https://github.com/shenwei356/LexicMap Usage: lexicmap [command] Available Commands: autocompletion Generate shell autocompletion script index Generate an index from FASTA/Q sequences search Search sequences against an index utils Some utilities version Print version information and check for update Flags: -h, --help help for lexicmap -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Use \u0026#34;lexicmap [command] --help\u0026#34; for more information about a command. ","description":"$ lexicmap -h LexicMap: efficient sequence alignment against millions of prokaryotic genomes Version: v0.3.0 Documents: https://bioinf.shenwei.me/LexicMap Source code: https://github.com/shenwei356/LexicMap Usage: lexicmap [command] Available Commands: autocompletion Generate shell autocompletion script index Generate an index from FASTA/Q sequences search Search sequences against an index utils Some utilities version Print version information and check for update Flags: -h, --help help for lexicmap -X, --infile-list string ► File of input files list (one file per line)."},{"id":20,"href":"/LexicMap/usage/utils/masks/","title":"masks","parent":"utils","content":"$ lexicmap utils masks -h View masks of the index or generate new masks randomly Usage: lexicmap utils masks [flags] { -d \u0026lt;index path\u0026gt; | [-k \u0026lt;k\u0026gt;] [-n \u0026lt;masks\u0026gt;] [-s \u0026lt;seed\u0026gt;] } [-o out.tsv.gz] Flags: -h, --help help for masks -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -k, --kmer int ► Maximum k-mer size. K needs to be \u0026lt;= 32. (default 31) -m, --masks int ► Number of masks. (default 1000) -o, --out-file string ► Out file, supports and recommends a \u0026#34;.gz\u0026#34; suffix (\u0026#34;-\u0026#34; for stdout). (default \u0026#34;-\u0026#34;) -p, --prefix int ► Length of mask k-mer prefix for checking low-complexity (0 for no checking). (default 15) -s, --seed int ► The seed for generating random masks. (default 1) Global Flags: -X, --infile-list string ► File of input files list (one file per line). If given, they are appended to files from CLI arguments. --log string ► Log file. --quiet ► Do not print any verbose information. But you can write them to a file with --log. -j, --threads int ► Number of CPUs cores to use. By default, it uses all available cores. (default 16) Examples $ lexicmap utils masks --quiet -d demo.lmi/ | head -n 10 1 AAAAAAACGTCATCGAACCGTGACTTTCTCC 2 AAAAAACCATTCAACAAGCTGTTCGACCCGG 3 AAAAAAGCCATCGTTGCAAGTACCATTGATC 4 AAAAAATAAGACTCTCGAGCATTTCTCACAA 5 AAAAACACCATCCCCGACTCGTATATGCCTC 6 AAAAACCACGCTGCCTGTCCAGCCATGGCCC 7 AAAAACGCCCCGCCAGGACTAATTCCGATTT 8 AAAAACTAGTGTATGCACAAGACGTACCTTC 9 AAAAAGAATAGTGCGCCGTCCTTTACACAGC 10 AAAAAGCCGGCGAAGAAATGCTTGCATGTTC $ lexicmap utils masks --quiet -d demo.lmi/ | tail -n 10 39991 TTTTTCGCCAGAGGATAGGTCTAAGAATAGC 39992 TTTTTCTAACATCACCGCGGATATTCTATAC 39993 TTTTTGAAGGCGCGGGCTCAGTGGGCTTTCT 39994 TTTTTGCATAATAGTTGTCGGGAGAAGTTTA 39995 TTTTTGGAAGGGGCACGCGGAGGAGCTGCAT 39996 TTTTTGTCCATGAGTCTAACAACTAGCCACC 39997 TTTTTTAAAATGCAAGATCTTATGTACAATT 39998 TTTTTTCCAGTGACCACGATGGGCACTTATA 39999 TTTTTTGCCGGAACCACGCTAGCGCCAGACG 40000 TTTTTTTATTGAAACGACAACCTAACGCGGG ","description":"$ lexicmap utils masks -h View masks of the index or generate new masks randomly Usage: lexicmap utils masks [flags] { -d \u0026lt;index path\u0026gt; | [-k \u0026lt;k\u0026gt;] [-n \u0026lt;masks\u0026gt;] [-s \u0026lt;seed\u0026gt;] } [-o out.tsv.gz] Flags: -h, --help help for masks -d, --index string ► Index directory created by \u0026#34;lexicmap index\u0026#34;. -k, --kmer int ► Maximum k-mer size. K needs to be \u0026lt;= 32. (default 31) -m, --masks int ► Number of masks."},{"id":21,"href":"/LexicMap/notes/motivation/","title":"Motivation","parent":"Notes","content":" BLASTN is not able to scale to millions of bacterial genomes, it\u0026rsquo;s slow and has a high memory occupation. For example, it requires \u0026gt;2000 GB for alignment a 2-kp gene sequence against all the 2.34 millions of prokaryotics genomes in Genbank and RefSeq.\nLarge-scale sequence searching tools only return which genomes a query matches (color), but they can\u0026rsquo;t return location information.\n","description":"BLASTN is not able to scale to millions of bacterial genomes, it\u0026rsquo;s slow and has a high memory occupation. For example, it requires \u0026gt;2000 GB for alignment a 2-kp gene sequence against all the 2.34 millions of prokaryotics genomes in Genbank and RefSeq.\nLarge-scale sequence searching tools only return which genomes a query matches (color), but they can\u0026rsquo;t return location information."},{"id":22,"href":"/LexicMap/tags/","title":"Tags","parent":"","content":"","description":""}]